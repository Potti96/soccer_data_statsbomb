<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Data Science Versicherung - Vorstellungsgespr√§ch Vorbereitung</title>
    <style>
        @media print {
            @page {
                size: A4;
                margin: 2cm;
            }
            body {
                font-size: 11pt;
            }
            h1, h2, h3, h4 {
                page-break-after: avoid;
            }
            pre, blockquote {
                page-break-inside: avoid;
            }
        }
        body {
            font-family: 'Segoe UI', Arial, sans-serif;
            font-size: 12pt;
            line-height: 1.6;
            color: #333;
            max-width: 900px;
            margin: 0 auto;
            padding: 20px;
            background-color: #fff;
        }
        h1 {
            font-size: 28pt;
            color: #2c3e50;
            border-bottom: 4px solid #3498db;
            padding-bottom: 15px;
            margin-bottom: 30px;
            page-break-after: avoid;
        }
        h2 {
            font-size: 20pt;
            color: #34495e;
            border-bottom: 2px solid #95a5a6;
            padding-bottom: 10px;
            margin-top: 35px;
            margin-bottom: 20px;
            page-break-after: avoid;
        }
        h3 {
            font-size: 16pt;
            color: #555;
            margin-top: 25px;
            margin-bottom: 15px;
            page-break-after: avoid;
        }
        h4 {
            font-size: 14pt;
            color: #666;
            margin-top: 20px;
            margin-bottom: 10px;
        }
        code {
            background-color: #f4f4f4;
            padding: 2px 6px;
            border-radius: 3px;
            font-family: 'Courier New', 'Consolas', monospace;
            font-size: 11pt;
        }
        pre {
            background-color: #f4f4f4;
            border: 1px solid #ddd;
            border-radius: 5px;
            padding: 15px;
            overflow-x: auto;
            page-break-inside: avoid;
        }
        pre code {
            background-color: transparent;
            padding: 0;
            display: block;
        }
        table {
            border-collapse: collapse;
            width: 100%;
            margin: 20px 0;
            page-break-inside: avoid;
        }
        th, td {
            border: 1px solid #ddd;
            padding: 10px;
            text-align: left;
        }
        th {
            background-color: #3498db;
            color: white;
            font-weight: bold;
        }
        tr:nth-child(even) {
            background-color: #f9f9f9;
        }
        ul, ol {
            margin: 15px 0;
            padding-left: 35px;
        }
        li {
            margin: 8px 0;
        }
        blockquote {
            border-left: 4px solid #3498db;
            margin: 20px 0;
            padding-left: 20px;
            color: #555;
            font-style: italic;
        }
        a {
            color: #3498db;
            text-decoration: none;
        }
        a:hover {
            text-decoration: underline;
        }
        hr {
            border: none;
            border-top: 2px solid #ecf0f1;
            margin: 30px 0;
        }
        .toc {
            background-color: #f8f9fa;
            border: 1px solid #dee2e6;
            padding: 20px;
            margin: 30px 0;
            border-radius: 5px;
        }
        .print-instructions {
            background-color: #fff3cd;
            border: 2px solid #ffc107;
            padding: 15px;
            margin-bottom: 30px;
            border-radius: 5px;
        }
        @media print {
            .print-instructions {
                display: none;
            }
        }
    </style>
</head>
<body>
    <div class="print-instructions">
        <strong>üìÑ Als PDF speichern:</strong><br>
        Dr√ºcke <strong>Strg+P</strong> (oder <strong>Cmd+P</strong> auf Mac) und w√§hle "Als PDF speichern" als Drucker.<br>
        Oder: Rechtsklick ‚Üí "Drucken" ‚Üí "Als PDF speichern"
    </div>
    <h1 id="data-science-in-der-versicherung-vorbereitung-fur-vorstellungsgesprach">Data Science in der Versicherung - Vorbereitung f√ºr Vorstellungsgespr√§ch</h1>
<h2 id="sachversicherung-operatives-controlling-data-scientist">Sachversicherung | Operatives Controlling | Data Scientist</h2>
<hr />
<h2 id="inhaltsverzeichnis">Inhaltsverzeichnis</h2>
<ol>
<li><a href="#1-schadenf√§lle-klassifizieren">Schadenf√§lle klassifizieren</a></li>
<li><a href="#2-wahrscheinlichkeitsmodelle">Wahrscheinlichkeitsmodelle</a></li>
<li><a href="#3-tarifierungsmerkmale-im-vertragsbereich">Tarifierungsmerkmale im Vertragsbereich</a></li>
<li><a href="#4-kennzahlensystem-von-schadensdaten">Kennzahlensystem von Schadensdaten</a></li>
<li><a href="#5-messwerte-zur-modellg√ºtepr√ºfung">Messwerte zur Modellg√ºtepr√ºfung</a></li>
<li><a href="#6-operatives-controlling-in-der-sachversicherung">Operatives Controlling in der Sachversicherung</a></li>
<li><a href="#7-case-study-vorbereitung">Case Study Vorbereitung</a></li>
</ol>
<hr />
<h2 id="1-schadenfalle-klassifizieren">1. Schadenf√§lle klassifizieren</h2>
<h3 id="11-uberblick">1.1 √úberblick</h3>
<p>Die Klassifikation von Schadenf√§llen ist zentral f√ºr:
- <strong>Risikobewertung</strong>: Identifikation von Mustern und Risikofaktoren
- <strong>Pr√§mienkalkulation</strong>: Anpassung von Tarifen basierend auf Schadenh√§ufigkeit
- <strong>Ressourcenplanung</strong>: Optimale Zuteilung von Bearbeitungskapazit√§ten
- <strong>Betrugserkennung</strong>: Identifikation verd√§chtiger Schadenf√§lle</p>
<h3 id="12-klassifikationsprobleme-in-der-versicherung">1.2 Klassifikationsprobleme in der Versicherung</h3>
<h4 id="121-binare-klassifikation">1.2.1 Bin√§re Klassifikation</h4>
<ul>
<li><strong>Frage</strong>: Ist ein Schadenfall legitim oder betr√ºgerisch?</li>
<li><strong>Ziel</strong>: Automatische Erkennung von Betrugsf√§llen</li>
<li><strong>Anwendung</strong>: Erstbewertung neuer Schadenf√§lle</li>
</ul>
<div class="codehilite"><pre><span></span><code><span class="kn">from</span><span class="w"> </span><span class="nn">sklearn.ensemble</span><span class="w"> </span><span class="kn">import</span> <span class="n">RandomForestClassifier</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">sklearn.model_selection</span><span class="w"> </span><span class="kn">import</span> <span class="n">train_test_split</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">sklearn.metrics</span><span class="w"> </span><span class="kn">import</span> <span class="n">classification_report</span><span class="p">,</span> <span class="n">confusion_matrix</span>

<span class="c1"># Beispiel: Betrugserkennung</span>
<span class="c1"># Features: Schadensh√∂he, Zeitpunkt, Versicherungsdauer, Historie, etc.</span>
<span class="n">X_train</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">y_test</span> <span class="o">=</span> <span class="n">train_test_split</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">test_size</span><span class="o">=</span><span class="mf">0.2</span><span class="p">)</span>

<span class="n">model</span> <span class="o">=</span> <span class="n">RandomForestClassifier</span><span class="p">(</span><span class="n">n_estimators</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">42</span><span class="p">)</span>
<span class="n">model</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>
<span class="n">predictions</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>
</code></pre></div>

<h4 id="122-multi-klassen-klassifikation">1.2.2 Multi-Klassen-Klassifikation</h4>
<ul>
<li><strong>Frage</strong>: Welcher Schadentyp liegt vor? (z.B. Brand, Wasserschaden, Diebstahl, Sturm)</li>
<li><strong>Ziel</strong>: Automatische Kategorisierung f√ºr besseres Routing</li>
<li><strong>Anwendung</strong>: Erstklassifikation bei Schadenmeldung</li>
</ul>
<div class="codehilite"><pre><span></span><code><span class="kn">from</span><span class="w"> </span><span class="nn">sklearn.linear_model</span><span class="w"> </span><span class="kn">import</span> <span class="n">LogisticRegression</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">sklearn.metrics</span><span class="w"> </span><span class="kn">import</span> <span class="n">accuracy_score</span><span class="p">,</span> <span class="n">f1_score</span>

<span class="c1"># Multi-Klassen-Klassifikation f√ºr Schadentypen</span>
<span class="n">model</span> <span class="o">=</span> <span class="n">LogisticRegression</span><span class="p">(</span><span class="n">multi_class</span><span class="o">=</span><span class="s1">&#39;multinomial&#39;</span><span class="p">,</span> <span class="n">solver</span><span class="o">=</span><span class="s1">&#39;lbfgs&#39;</span><span class="p">)</span>
<span class="n">model</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>

<span class="c1"># Vorhersage und Evaluation</span>
<span class="n">predictions</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>
<span class="n">accuracy</span> <span class="o">=</span> <span class="n">accuracy_score</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">predictions</span><span class="p">)</span>
<span class="n">f1_macro</span> <span class="o">=</span> <span class="n">f1_score</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">predictions</span><span class="p">,</span> <span class="n">average</span><span class="o">=</span><span class="s1">&#39;macro&#39;</span><span class="p">)</span>
</code></pre></div>

<h3 id="13-wichtige-features-fur-schadenklassifikation">1.3 Wichtige Features f√ºr Schadenklassifikation</h3>
<h4 id="131-versicherungsbezogene-features">1.3.1 Versicherungsbezogene Features</h4>
<ul>
<li><strong>Vertragsmerkmale</strong>: Versicherungsdauer, Deckungsumfang, Selbstbeteiligung</li>
<li><strong>Versicherungssumme</strong>: Versicherter Wert</li>
<li><strong>Tarifgruppe</strong>: Bisherige Pr√§mie, Risikoklasse</li>
<li><strong>Historie</strong>: Anzahl fr√ºherer Sch√§den, Schadenkosten in der Vergangenheit</li>
</ul>
<h4 id="132-schadenbezogene-features">1.3.2 Schadenbezogene Features</h4>
<ul>
<li><strong>Schadensh√∂he</strong>: Gesch√§tzter oder tats√§chlicher Schaden</li>
<li><strong>Schadentyp</strong>: Kategorie (Brand, Wasser, etc.)</li>
<li><strong>Schadenursache</strong>: Beschreibung der Ursache</li>
<li><strong>Zeitpunkt</strong>: Datum, Saison, Tageszeit</li>
</ul>
<h4 id="133-objektbezogene-features">1.3.3 Objektbezogene Features</h4>
<ul>
<li><strong>Objekttyp</strong>: Wohnung, Haus, Gewerbeobjekt</li>
<li><strong>Standort</strong>: PLZ, Region, Risikogebiet (√úberschwemmung, etc.)</li>
<li><strong>Alter/Gr√∂√üe</strong>: Baujahr, Wohnfl√§che, etc.</li>
<li><strong>Nutzung</strong>: Wohnung, B√ºro, Lager, etc.</li>
</ul>
<h3 id="14-praktische-implementierung">1.4 Praktische Implementierung</h3>
<div class="codehilite"><pre><span></span><code><span class="kn">import</span><span class="w"> </span><span class="nn">pandas</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">pd</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">sklearn.preprocessing</span><span class="w"> </span><span class="kn">import</span> <span class="n">LabelEncoder</span><span class="p">,</span> <span class="n">StandardScaler</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">sklearn.ensemble</span><span class="w"> </span><span class="kn">import</span> <span class="n">GradientBoostingClassifier</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">sklearn.model_selection</span><span class="w"> </span><span class="kn">import</span> <span class="n">cross_val_score</span>

<span class="c1"># Datenaufbereitung</span>
<span class="k">def</span><span class="w"> </span><span class="nf">prepare_schaden_data</span><span class="p">(</span><span class="n">df</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Schadensdaten f√ºr Klassifikation vorbereiten&quot;&quot;&quot;</span>

    <span class="c1"># Kategorische Variablen encodieren</span>
    <span class="n">le</span> <span class="o">=</span> <span class="n">LabelEncoder</span><span class="p">()</span>
    <span class="n">categorical_cols</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;schadentyp&#39;</span><span class="p">,</span> <span class="s1">&#39;objekttyp&#39;</span><span class="p">,</span> <span class="s1">&#39;region&#39;</span><span class="p">,</span> <span class="s1">&#39;ursache&#39;</span><span class="p">]</span>

    <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">categorical_cols</span><span class="p">:</span>
        <span class="n">df</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">col</span><span class="si">}</span><span class="s1">_encoded&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">le</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="n">col</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">str</span><span class="p">))</span>

    <span class="c1"># Numerische Features normalisieren</span>
    <span class="n">scaler</span> <span class="o">=</span> <span class="n">StandardScaler</span><span class="p">()</span>
    <span class="n">numerical_cols</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;schadenshoehe&#39;</span><span class="p">,</span> <span class="s1">&#39;versicherungssumme&#39;</span><span class="p">,</span> <span class="s1">&#39;versicherungsdauer&#39;</span><span class="p">]</span>
    <span class="n">df</span><span class="p">[</span><span class="n">numerical_cols</span><span class="p">]</span> <span class="o">=</span> <span class="n">scaler</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="n">numerical_cols</span><span class="p">])</span>

    <span class="k">return</span> <span class="n">df</span>

<span class="c1"># Modelltraining</span>
<span class="k">def</span><span class="w"> </span><span class="nf">train_schaden_classifier</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Schadenklassifikator trainieren&quot;&quot;&quot;</span>

    <span class="n">model</span> <span class="o">=</span> <span class="n">GradientBoostingClassifier</span><span class="p">(</span>
        <span class="n">n_estimators</span><span class="o">=</span><span class="mi">200</span><span class="p">,</span>
        <span class="n">learning_rate</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span>
        <span class="n">max_depth</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span>
        <span class="n">random_state</span><span class="o">=</span><span class="mi">42</span>
    <span class="p">)</span>

    <span class="c1"># Cross-Validation</span>
    <span class="n">cv_scores</span> <span class="o">=</span> <span class="n">cross_val_score</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">cv</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">scoring</span><span class="o">=</span><span class="s1">&#39;f1_macro&#39;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;F1-Score (Cross-Validation): </span><span class="si">{</span><span class="n">cv_scores</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span><span class="si">:</span><span class="s2">.3f</span><span class="si">}</span><span class="s2"> (+/- </span><span class="si">{</span><span class="n">cv_scores</span><span class="o">.</span><span class="n">std</span><span class="p">()</span><span class="o">*</span><span class="mi">2</span><span class="si">:</span><span class="s2">.3f</span><span class="si">}</span><span class="s2">)&quot;</span><span class="p">)</span>

    <span class="c1"># Finales Modell trainieren</span>
    <span class="n">model</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">model</span>

<span class="c1"># Feature Importance analysieren</span>
<span class="k">def</span><span class="w"> </span><span class="nf">analyze_feature_importance</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">feature_names</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Wichtigste Features f√ºr Klassifikation identifizieren&quot;&quot;&quot;</span>

    <span class="n">importances</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">feature_importances_</span>
    <span class="n">indices</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">argsort</span><span class="p">(</span><span class="n">importances</span><span class="p">)[::</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>

    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Top 10 wichtigste Features:&quot;</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">):</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="si">}</span><span class="s2">. </span><span class="si">{</span><span class="n">feature_names</span><span class="p">[</span><span class="n">indices</span><span class="p">[</span><span class="n">i</span><span class="p">]]</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="n">importances</span><span class="p">[</span><span class="n">indices</span><span class="p">[</span><span class="n">i</span><span class="p">]]</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">importances</span>
</code></pre></div>

<h3 id="15-anwendungsfalle-im-operativen-controlling">1.5 Anwendungsf√§lle im operativen Controlling</h3>
<ul>
<li><strong>Automatisches Schaden-Routing</strong>: Schadenf√§lle automatisch an richtige Abteilung weiterleiten</li>
<li><strong>Ressourcenplanung</strong>: Erwartete Bearbeitungszeiten sch√§tzen</li>
<li><strong>Betrugspr√§vention</strong>: Verd√§chtige F√§lle fr√ºhzeitig identifizieren</li>
<li><strong>Kostensteuerung</strong>: High-value Sch√§den priorisieren</li>
</ul>
<hr />
<h2 id="2-wahrscheinlichkeitsmodelle">2. Wahrscheinlichkeitsmodelle</h2>
<h3 id="21-grundlagen">2.1 Grundlagen</h3>
<p>Wahrscheinlichkeitsmodelle sind Kern der Versicherungsmathematik und erm√∂glichen:
- <strong>Schadenwahrscheinlichkeit</strong>: Wie wahrscheinlich ist ein Schaden?
- <strong>Schadenh√∂he</strong>: Wie hoch wird der Schaden erwartungsgem√§√ü sein?
- <strong>Risikobewertung</strong>: Kombination von H√§ufigkeit und Schwere</p>
<h3 id="22-haufigkeitsverteilungen-claim-frequency">2.2 H√§ufigkeitsverteilungen (Claim Frequency)</h3>
<h4 id="221-poisson-verteilung">2.2.1 Poisson-Verteilung</h4>
<ul>
<li><strong>Anwendung</strong>: Anzahl der Sch√§den pro Versicherungsperiode</li>
<li><strong>Annahme</strong>: Seltene, unabh√§ngige Ereignisse</li>
<li><strong>Parameter</strong>: Œª (Lambda) = erwartete Anzahl Sch√§den</li>
</ul>
<div class="codehilite"><pre><span></span><code><span class="kn">from</span><span class="w"> </span><span class="nn">scipy</span><span class="w"> </span><span class="kn">import</span> <span class="n">stats</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>

<span class="c1"># Poisson-Verteilung f√ºr Schadenh√§ufigkeit</span>
<span class="n">lambda_param</span> <span class="o">=</span> <span class="mf">0.5</span>  <span class="c1"># z.B. 0.5 Sch√§den pro Jahr im Durchschnitt</span>

<span class="c1"># Wahrscheinlichkeit f√ºr k Sch√§den</span>
<span class="n">k</span> <span class="o">=</span> <span class="mi">2</span>
<span class="n">prob_k_claims</span> <span class="o">=</span> <span class="n">stats</span><span class="o">.</span><span class="n">poisson</span><span class="o">.</span><span class="n">pmf</span><span class="p">(</span><span class="n">k</span><span class="p">,</span> <span class="n">lambda_param</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Wahrscheinlichkeit f√ºr </span><span class="si">{</span><span class="n">k</span><span class="si">}</span><span class="s2"> Sch√§den: </span><span class="si">{</span><span class="n">prob_k_claims</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="c1"># Kumulative Verteilung</span>
<span class="n">prob_at_least_one</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">-</span> <span class="n">stats</span><span class="o">.</span><span class="n">poisson</span><span class="o">.</span><span class="n">pmf</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">lambda_param</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Wahrscheinlichkeit f√ºr mindestens 1 Schaden: </span><span class="si">{</span><span class="n">prob_at_least_one</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="c1"># Beispiel: H√§ufigkeitsmodellierung f√ºr verschiedene Risikogruppen</span>
<span class="n">risk_groups</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">&#39;niedrig&#39;</span><span class="p">:</span> <span class="mf">0.1</span><span class="p">,</span>   <span class="c1"># 0.1 Sch√§den/Jahr</span>
    <span class="s1">&#39;mittel&#39;</span><span class="p">:</span> <span class="mf">0.5</span><span class="p">,</span>    <span class="c1"># 0.5 Sch√§den/Jahr</span>
    <span class="s1">&#39;hoch&#39;</span><span class="p">:</span> <span class="mf">1.2</span>       <span class="c1"># 1.2 Sch√§den/Jahr</span>
<span class="p">}</span>

<span class="k">for</span> <span class="n">group</span><span class="p">,</span> <span class="n">lambda_val</span> <span class="ow">in</span> <span class="n">risk_groups</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
    <span class="n">expected_claims</span> <span class="o">=</span> <span class="n">lambda_val</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">group</span><span class="o">.</span><span class="n">capitalize</span><span class="p">()</span><span class="si">}</span><span class="s2">es Risiko: </span><span class="si">{</span><span class="n">expected_claims</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2"> erwartete Sch√§den/Jahr&quot;</span><span class="p">)</span>
</code></pre></div>

<h4 id="222-negative-binomialverteilung">2.2.2 Negative Binomialverteilung</h4>
<ul>
<li><strong>Anwendung</strong>: Wenn Varianz &gt; Mittelwert (√úberdispersion)</li>
<li><strong>Vorteil</strong>: Flexibler als Poisson, ber√ºcksichtigt Heterogenit√§t</li>
<li><strong>Parameter</strong>: r (Anzahl Erfolge), p (Erfolgswahrscheinlichkeit)</li>
</ul>
<div class="codehilite"><pre><span></span><code><span class="c1"># Negative Binomial f√ºr √ºberdispergierte Schadenh√§ufigkeit</span>
<span class="n">r</span> <span class="o">=</span> <span class="mi">2</span>
<span class="n">p</span> <span class="o">=</span> <span class="mf">0.4</span>

<span class="c1"># Wahrscheinlichkeitsverteilung</span>
<span class="n">k_values</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">6</span><span class="p">)</span>
<span class="n">probs</span> <span class="o">=</span> <span class="n">stats</span><span class="o">.</span><span class="n">nbinom</span><span class="o">.</span><span class="n">pmf</span><span class="p">(</span><span class="n">k_values</span><span class="p">,</span> <span class="n">r</span><span class="p">,</span> <span class="n">p</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Negative Binomial - Schadenh√§ufigkeit:&quot;</span><span class="p">)</span>
<span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">prob</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">k_values</span><span class="p">,</span> <span class="n">probs</span><span class="p">):</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  </span><span class="si">{</span><span class="n">k</span><span class="si">}</span><span class="s2"> Sch√§den: </span><span class="si">{</span><span class="n">prob</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</code></pre></div>

<h3 id="23-schwereverteilungen-claim-severity">2.3 Schwereverteilungen (Claim Severity)</h3>
<h4 id="231-lognormale-verteilung">2.3.1 Lognormale Verteilung</h4>
<ul>
<li><strong>Anwendung</strong>: Schadenh√∂hen (h√§ufig f√ºr Sachversicherung)</li>
<li><strong>Vorteil</strong>: Positiv, rechtssteil (wie typische Schadenh√∂hen)</li>
<li><strong>Parameter</strong>: Œº (Mittelwert des Logs), œÉ (Standardabweichung des Logs)</li>
</ul>
<div class="codehilite"><pre><span></span><code><span class="c1"># Lognormale Verteilung f√ºr Schadenh√∂hen</span>
<span class="n">mu</span> <span class="o">=</span> <span class="mi">7</span>      <span class="c1"># Mittelwert des Logarithmus</span>
<span class="n">sigma</span> <span class="o">=</span> <span class="mf">1.5</span>  <span class="c1"># Standardabweichung des Logarithmus</span>

<span class="c1"># Zuf√§llige Schadenh√∂hen generieren</span>
<span class="n">sample_claims</span> <span class="o">=</span> <span class="n">stats</span><span class="o">.</span><span class="n">lognorm</span><span class="o">.</span><span class="n">rvs</span><span class="p">(</span><span class="n">s</span><span class="o">=</span><span class="n">sigma</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">mu</span><span class="p">),</span> <span class="n">size</span><span class="o">=</span><span class="mi">1000</span><span class="p">)</span>

<span class="c1"># Statistiken</span>
<span class="n">mean_claim</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">sample_claims</span><span class="p">)</span>
<span class="n">median_claim</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">median</span><span class="p">(</span><span class="n">sample_claims</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Mittlere Schadenh√∂he: ‚Ç¨</span><span class="si">{</span><span class="n">mean_claim</span><span class="si">:</span><span class="s2">,.2f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Median Schadenh√∂he: ‚Ç¨</span><span class="si">{</span><span class="n">median_claim</span><span class="si">:</span><span class="s2">,.2f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="c1"># Wahrscheinlichkeit, dass Schaden &gt; Schwellwert</span>
<span class="n">threshold</span> <span class="o">=</span> <span class="mi">10000</span>
<span class="n">prob_large</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">-</span> <span class="n">stats</span><span class="o">.</span><span class="n">lognorm</span><span class="o">.</span><span class="n">cdf</span><span class="p">(</span><span class="n">threshold</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="n">sigma</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">mu</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Wahrscheinlichkeit f√ºr Schaden &gt; ‚Ç¨</span><span class="si">{</span><span class="n">threshold</span><span class="si">:</span><span class="s2">,.2f</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="n">prob_large</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</code></pre></div>

<h4 id="232-gamma-verteilung">2.3.2 Gamma-Verteilung</h4>
<ul>
<li><strong>Anwendung</strong>: Alternative f√ºr Schadenh√∂hen</li>
<li><strong>Vorteil</strong>: Flexibel in Form, gut f√ºr verschiedene Schadentypen</li>
<li><strong>Parameter</strong>: Œ± (Shape), Œ≤ (Rate)</li>
</ul>
<div class="codehilite"><pre><span></span><code><span class="c1"># Gamma-Verteilung f√ºr Schadenh√∂hen</span>
<span class="n">alpha</span> <span class="o">=</span> <span class="mi">2</span>
<span class="n">beta</span> <span class="o">=</span> <span class="mf">0.001</span>  <span class="c1"># Rate parameter</span>

<span class="c1"># Erwartungswert und Varianz</span>
<span class="n">expected_value</span> <span class="o">=</span> <span class="n">alpha</span> <span class="o">/</span> <span class="n">beta</span>
<span class="n">variance</span> <span class="o">=</span> <span class="n">alpha</span> <span class="o">/</span> <span class="p">(</span><span class="n">beta</span> <span class="o">**</span> <span class="mi">2</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Erwartete Schadenh√∂he: ‚Ç¨</span><span class="si">{</span><span class="n">expected_value</span><span class="si">:</span><span class="s2">,.2f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Varianz: ‚Ç¨</span><span class="si">{</span><span class="n">variance</span><span class="si">:</span><span class="s2">,.2f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</code></pre></div>

<h4 id="233-pareto-verteilung">2.3.3 Pareto-Verteilung</h4>
<ul>
<li><strong>Anwendung</strong>: Gro√üe Sch√§den (Tail-Risiko)</li>
<li><strong>Vorteil</strong>: Modelliert seltene, aber sehr hohe Sch√§den</li>
<li><strong>Wichtig</strong>: F√ºr Extremwertanalyse</li>
</ul>
<div class="codehilite"><pre><span></span><code><span class="c1"># Pareto-Verteilung f√ºr extreme Sch√§den</span>
<span class="n">alpha</span> <span class="o">=</span> <span class="mf">2.5</span>  <span class="c1"># Shape parameter</span>
<span class="n">xmin</span> <span class="o">=</span> <span class="mi">10000</span>  <span class="c1"># Minimum-Schwellwert</span>

<span class="c1"># Wahrscheinlichkeit f√ºr sehr hohe Sch√§den</span>
<span class="n">very_high_claim</span> <span class="o">=</span> <span class="mi">50000</span>
<span class="n">prob_extreme</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">-</span> <span class="n">stats</span><span class="o">.</span><span class="n">pareto</span><span class="o">.</span><span class="n">cdf</span><span class="p">(</span><span class="n">very_high_claim</span> <span class="o">/</span> <span class="n">xmin</span><span class="p">,</span> <span class="n">alpha</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Wahrscheinlichkeit f√ºr Schaden &gt; ‚Ç¨</span><span class="si">{</span><span class="n">very_high_claim</span><span class="si">:</span><span class="s2">,.2f</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="n">prob_extreme</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</code></pre></div>

<h3 id="24-compound-modelle-haufigkeit-schwere">2.4 Compound-Modelle (H√§ufigkeit √ó Schwere)</h3>
<h4 id="241-gesamtschadenverteilung">2.4.1 Gesamtschadenverteilung</h4>
<p>Gesamtschaden = Summe aller einzelnen Sch√§den in einer Periode</p>
<div class="codehilite"><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">simulate_total_loss</span><span class="p">(</span><span class="n">frequency_param</span><span class="p">,</span> <span class="n">severity_params</span><span class="p">,</span> <span class="n">n_simulations</span><span class="o">=</span><span class="mi">10000</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Simuliere Gesamtschadenverteilung</span>

<span class="sd">    Parameters:</span>
<span class="sd">    - frequency_param: Lambda f√ºr Poisson (H√§ufigkeit)</span>
<span class="sd">    - severity_params: (mu, sigma) f√ºr Lognormal (Schwere)</span>
<span class="sd">    - n_simulations: Anzahl Simulationen</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">total_losses</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_simulations</span><span class="p">):</span>
        <span class="c1"># Anzahl Sch√§den</span>
        <span class="n">n_claims</span> <span class="o">=</span> <span class="n">stats</span><span class="o">.</span><span class="n">poisson</span><span class="o">.</span><span class="n">rvs</span><span class="p">(</span><span class="n">frequency_param</span><span class="p">)</span>

        <span class="c1"># Summe der Schadenh√∂hen</span>
        <span class="k">if</span> <span class="n">n_claims</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">individual_claims</span> <span class="o">=</span> <span class="n">stats</span><span class="o">.</span><span class="n">lognorm</span><span class="o">.</span><span class="n">rvs</span><span class="p">(</span>
                <span class="n">s</span><span class="o">=</span><span class="n">severity_params</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span>
                <span class="n">scale</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">severity_params</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span>
                <span class="n">size</span><span class="o">=</span><span class="n">n_claims</span>
            <span class="p">)</span>
            <span class="n">total_loss</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">individual_claims</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">total_loss</span> <span class="o">=</span> <span class="mi">0</span>

        <span class="n">total_losses</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">total_loss</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">total_losses</span><span class="p">)</span>

<span class="c1"># Beispiel: Gesamtschaden pro Jahr simulieren</span>
<span class="n">lambda_annual</span> <span class="o">=</span> <span class="mf">0.8</span>  <span class="c1"># 0.8 Sch√§den pro Jahr im Durchschnitt</span>
<span class="n">mu_severity</span><span class="p">,</span> <span class="n">sigma_severity</span> <span class="o">=</span> <span class="mi">7</span><span class="p">,</span> <span class="mf">1.5</span>  <span class="c1"># Lognormal Parameter f√ºr Schadenh√∂he</span>

<span class="n">total_losses</span> <span class="o">=</span> <span class="n">simulate_total_loss</span><span class="p">(</span><span class="n">lambda_annual</span><span class="p">,</span> <span class="p">(</span><span class="n">mu_severity</span><span class="p">,</span> <span class="n">sigma_severity</span><span class="p">))</span>

<span class="c1"># Statistiken</span>
<span class="n">mean_total</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">total_losses</span><span class="p">)</span>
<span class="n">var95</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">percentile</span><span class="p">(</span><span class="n">total_losses</span><span class="p">,</span> <span class="mi">95</span><span class="p">)</span>
<span class="n">var99</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">percentile</span><span class="p">(</span><span class="n">total_losses</span><span class="p">,</span> <span class="mi">99</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Erwarteter Gesamtschaden: ‚Ç¨</span><span class="si">{</span><span class="n">mean_total</span><span class="si">:</span><span class="s2">,.2f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Value at Risk (95%): ‚Ç¨</span><span class="si">{</span><span class="n">var95</span><span class="si">:</span><span class="s2">,.2f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Value at Risk (99%): ‚Ç¨</span><span class="si">{</span><span class="n">var99</span><span class="si">:</span><span class="s2">,.2f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</code></pre></div>

<h3 id="25-regressionsmodelle-fur-wahrscheinlichkeiten">2.5 Regressionsmodelle f√ºr Wahrscheinlichkeiten</h3>
<h4 id="251-poisson-regression">2.5.1 Poisson-Regression</h4>
<ul>
<li><strong>Ziel</strong>: Schadenh√§ufigkeit basierend auf Risikofaktoren modellieren</li>
<li><strong>Anwendung</strong>: GLM (Generalized Linear Model)</li>
</ul>
<div class="codehilite"><pre><span></span><code><span class="kn">from</span><span class="w"> </span><span class="nn">sklearn.linear_model</span><span class="w"> </span><span class="kn">import</span> <span class="n">PoissonRegressor</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">statsmodels.api</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">sm</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">statsmodels.discrete.discrete_model</span><span class="w"> </span><span class="kn">import</span> <span class="n">Poisson</span>

<span class="c1"># Poisson Regression f√ºr H√§ufigkeitsmodellierung</span>
<span class="c1"># Beispiel: Schadenh√§ufigkeit basierend auf Objekttyp, Region, etc.</span>

<span class="c1"># Mit statsmodels (bessere Statistiken)</span>
<span class="n">X</span> <span class="o">=</span> <span class="n">sm</span><span class="o">.</span><span class="n">add_constant</span><span class="p">(</span><span class="n">X_features</span><span class="p">)</span>  <span class="c1"># Features mit Konstante</span>
<span class="n">y_frequency</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;anzahl_schaeden&#39;</span><span class="p">]</span>  <span class="c1"># Anzahl Sch√§den als Zielvariable</span>

<span class="n">poisson_model</span> <span class="o">=</span> <span class="n">Poisson</span><span class="p">(</span><span class="n">y_frequency</span><span class="p">,</span> <span class="n">X</span><span class="p">)</span>
<span class="n">poisson_results</span> <span class="o">=</span> <span class="n">poisson_model</span><span class="o">.</span><span class="n">fit</span><span class="p">()</span>

<span class="nb">print</span><span class="p">(</span><span class="n">poisson_results</span><span class="o">.</span><span class="n">summary</span><span class="p">())</span>

<span class="c1"># Mit scikit-learn (einfacher zu nutzen)</span>
<span class="n">model</span> <span class="o">=</span> <span class="n">PoissonRegressor</span><span class="p">(</span><span class="n">alpha</span><span class="o">=</span><span class="mf">0.1</span><span class="p">)</span>
<span class="n">model</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_features</span><span class="p">,</span> <span class="n">y_frequency</span><span class="p">)</span>

<span class="c1"># Vorhersage: Erwartete Anzahl Sch√§den f√ºr neuen Vertrag</span>
<span class="n">expected_frequency</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">new_contract_features</span><span class="p">)</span>
</code></pre></div>

<h4 id="252-gamma-regression">2.5.2 Gamma-Regression</h4>
<ul>
<li><strong>Ziel</strong>: Schadenh√∂he basierend auf Risikofaktoren modellieren</li>
<li><strong>Link-Funktion</strong>: Logarithmus (log-link)</li>
</ul>
<div class="codehilite"><pre><span></span><code><span class="kn">from</span><span class="w"> </span><span class="nn">statsmodels.genmod.generalized_linear_model</span><span class="w"> </span><span class="kn">import</span> <span class="n">GLM</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">statsmodels.genmod</span><span class="w"> </span><span class="kn">import</span> <span class="n">families</span>

<span class="c1"># Gamma Regression f√ºr Schadenh√∂henmodellierung</span>
<span class="n">y_severity</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;schadenshoehe&#39;</span><span class="p">]</span>  <span class="c1"># Schadenh√∂he als Zielvariable</span>
<span class="n">X_features</span> <span class="o">=</span> <span class="n">df</span><span class="p">[[</span><span class="s1">&#39;objekttyp&#39;</span><span class="p">,</span> <span class="s1">&#39;region&#39;</span><span class="p">,</span> <span class="s1">&#39;alter&#39;</span><span class="p">,</span> <span class="s1">&#39;versicherungssumme&#39;</span><span class="p">]]</span>

<span class="c1"># GLM mit Gamma-Familie und log-link</span>
<span class="n">gamma_model</span> <span class="o">=</span> <span class="n">GLM</span><span class="p">(</span><span class="n">y_severity</span><span class="p">,</span> <span class="n">X_features</span><span class="p">,</span> <span class="n">family</span><span class="o">=</span><span class="n">families</span><span class="o">.</span><span class="n">Gamma</span><span class="p">(</span><span class="n">families</span><span class="o">.</span><span class="n">links</span><span class="o">.</span><span class="n">log</span><span class="p">()))</span>
<span class="n">gamma_results</span> <span class="o">=</span> <span class="n">gamma_model</span><span class="o">.</span><span class="n">fit</span><span class="p">()</span>

<span class="nb">print</span><span class="p">(</span><span class="n">gamma_results</span><span class="o">.</span><span class="n">summary</span><span class="p">())</span>
</code></pre></div>

<h3 id="26-anwendungsfalle-im-operativen-controlling">2.6 Anwendungsf√§lle im operativen Controlling</h3>
<ul>
<li><strong>Reservierung</strong>: Statistische Reserven f√ºr offene Sch√§den</li>
<li><strong>Pr√§mienkalkulation</strong>: Erwartete Schadenkosten pro Risiko</li>
<li><strong>Risikomanagement</strong>: VaR (Value at Risk) Berechnung</li>
<li><strong>Planung</strong>: Prognose erwarteter Schadenkosten</li>
</ul>
<hr />
<h2 id="3-tarifierungsmerkmale-im-vertragsbereich">3. Tarifierungsmerkmale im Vertragsbereich</h2>
<h3 id="31-uberblick">3.1 √úberblick</h3>
<p>Tarifierungsmerkmale sind Variablen, die zur Pr√§mienberechnung verwendet werden:
- <strong>Ziel</strong>: Risiko-ad√§quate Pr√§mien
- <strong>Prinzip</strong>: Gleiche Risiken ‚Üí gleiche Pr√§mien
- <strong>Rechtliche Anforderungen</strong>: Transparenz, Diskriminierungsverbot</p>
<h3 id="32-typische-tarifierungsmerkmale-in-der-sachversicherung">3.2 Typische Tarifierungsmerkmale in der Sachversicherung</h3>
<h4 id="321-objektbezogene-merkmale">3.2.1 Objektbezogene Merkmale</h4>
<ul>
<li><strong>Objekttyp</strong>: Wohnung, Haus, Gewerbeobjekt</li>
<li><strong>Baujahr</strong>: Alter des Geb√§udes</li>
<li><strong>Geb√§udeart</strong>: Massivbau, Holzbau, etc.</li>
<li><strong>Gr√∂√üe</strong>: Wohnfl√§che, Grundst√ºcksgr√∂√üe</li>
<li><strong>Wohnsituation</strong>: Eigennutzung, Vermietung</li>
</ul>
<h4 id="322-standortmerkmale">3.2.2 Standortmerkmale</h4>
<ul>
<li><strong>Region/PLZ</strong>: Geografische Lage</li>
<li><strong>Risikogebiet</strong>: √úberschwemmungsgebiet, Erdbebenzone</li>
<li><strong>Kriminalit√§tsrate</strong>: Einbruchrisiko</li>
<li><strong>Infrastruktur</strong>: Feuerwehr-Erreichbarkeit</li>
</ul>
<h4 id="323-vertragsbezogene-merkmale">3.2.3 Vertragsbezogene Merkmale</h4>
<ul>
<li><strong>Versicherungssumme</strong>: H√∂he der Deckung</li>
<li><strong>Selbstbeteiligung</strong>: Eigenanteil bei Schaden</li>
<li><strong>Deckungsumfang</strong>: Welche Risiken sind abgedeckt</li>
<li><strong>Laufzeit</strong>: Vertragsdauer</li>
</ul>
<h4 id="324-historische-merkmale">3.2.4 Historische Merkmale</h4>
<ul>
<li><strong>Schadenhistorie</strong>: Anzahl/Schwere fr√ºherer Sch√§den</li>
<li><strong>Vertragsdauer</strong>: Seit wann bei dieser Versicherung</li>
<li><strong>Wechselh√§ufigkeit</strong>: Versichererwechsel in der Vergangenheit</li>
</ul>
<h3 id="33-feature-engineering-fur-tarifierung">3.3 Feature Engineering f√ºr Tarifierung</h3>
<div class="codehilite"><pre><span></span><code><span class="kn">import</span><span class="w"> </span><span class="nn">pandas</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">pd</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">sklearn.preprocessing</span><span class="w"> </span><span class="kn">import</span> <span class="n">StandardScaler</span><span class="p">,</span> <span class="n">LabelEncoder</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">sklearn.feature_selection</span><span class="w"> </span><span class="kn">import</span> <span class="n">mutual_info_regression</span>

<span class="k">def</span><span class="w"> </span><span class="nf">prepare_tarification_features</span><span class="p">(</span><span class="n">df</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Tarifierungsmerkmale aufbereiten&quot;&quot;&quot;</span>

    <span class="c1"># 1. Kategorische Variablen encodieren</span>
    <span class="n">categorical_cols</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;objekttyp&#39;</span><span class="p">,</span> <span class="s1">&#39;region&#39;</span><span class="p">,</span> <span class="s1">&#39;bauart&#39;</span><span class="p">,</span> <span class="s1">&#39;deckungsumfang&#39;</span><span class="p">]</span>

    <span class="c1"># Option 1: One-Hot Encoding</span>
    <span class="n">df_encoded</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">get_dummies</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="n">categorical_cols</span><span class="p">,</span> <span class="n">prefix</span><span class="o">=</span><span class="n">categorical_cols</span><span class="p">)</span>

    <span class="c1"># Option 2: Target Encoding (besser f√ºr stark kardinale Variablen)</span>
    <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">categorical_cols</span><span class="p">:</span>
        <span class="n">target_mean</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="n">col</span><span class="p">)[</span><span class="s1">&#39;praemie&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
        <span class="n">df</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">col</span><span class="si">}</span><span class="s1">_target_encoded&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">col</span><span class="p">]</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="n">target_mean</span><span class="p">)</span>

    <span class="c1"># 2. Interaktionsterme erstellen</span>
    <span class="n">df</span><span class="p">[</span><span class="s1">&#39;wohnflaeche_x_objekttyp&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;wohnflaeche&#39;</span><span class="p">]</span> <span class="o">*</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;objekttyp_encoded&#39;</span><span class="p">]</span>
    <span class="n">df</span><span class="p">[</span><span class="s1">&#39;alter_x_region&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;baujahr&#39;</span><span class="p">]</span> <span class="o">*</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;region_encoded&#39;</span><span class="p">]</span>

    <span class="c1"># 3. Transformationen</span>
    <span class="n">df</span><span class="p">[</span><span class="s1">&#39;log_versicherungssumme&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">log1p</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;versicherungssumme&#39;</span><span class="p">])</span>
    <span class="n">df</span><span class="p">[</span><span class="s1">&#39;versicherungssumme_per_qm&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;versicherungssumme&#39;</span><span class="p">]</span> <span class="o">/</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;wohnflaeche&#39;</span><span class="p">]</span>

    <span class="c1"># 4. Zeitbasierte Features</span>
    <span class="n">df</span><span class="p">[</span><span class="s1">&#39;vertragsdauer_jahre&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">Timestamp</span><span class="o">.</span><span class="n">now</span><span class="p">()</span> <span class="o">-</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;vertragsbeginn&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">dt</span><span class="o">.</span><span class="n">days</span> <span class="o">/</span> <span class="mi">365</span>
    <span class="n">df</span><span class="p">[</span><span class="s1">&#39;saison&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;vertragsbeginn&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">dt</span><span class="o">.</span><span class="n">month</span><span class="o">.</span><span class="n">map</span><span class="p">({</span>
        <span class="mi">12</span><span class="p">:</span> <span class="s1">&#39;Winter&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">:</span> <span class="s1">&#39;Winter&#39;</span><span class="p">,</span> <span class="mi">2</span><span class="p">:</span> <span class="s1">&#39;Winter&#39;</span><span class="p">,</span>
        <span class="mi">3</span><span class="p">:</span> <span class="s1">&#39;Fr√ºhling&#39;</span><span class="p">,</span> <span class="mi">4</span><span class="p">:</span> <span class="s1">&#39;Fr√ºhling&#39;</span><span class="p">,</span> <span class="mi">5</span><span class="p">:</span> <span class="s1">&#39;Fr√ºhling&#39;</span><span class="p">,</span>
        <span class="mi">6</span><span class="p">:</span> <span class="s1">&#39;Sommer&#39;</span><span class="p">,</span> <span class="mi">7</span><span class="p">:</span> <span class="s1">&#39;Sommer&#39;</span><span class="p">,</span> <span class="mi">8</span><span class="p">:</span> <span class="s1">&#39;Sommer&#39;</span><span class="p">,</span>
        <span class="mi">9</span><span class="p">:</span> <span class="s1">&#39;Herbst&#39;</span><span class="p">,</span> <span class="mi">10</span><span class="p">:</span> <span class="s1">&#39;Herbst&#39;</span><span class="p">,</span> <span class="mi">11</span><span class="p">:</span> <span class="s1">&#39;Herbst&#39;</span>
    <span class="p">})</span>

    <span class="k">return</span> <span class="n">df</span>

<span class="c1"># Feature Importance f√ºr Tarifierung</span>
<span class="k">def</span><span class="w"> </span><span class="nf">analyze_tarification_features</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Wichtige Tarifierungsmerkmale identifizieren&quot;&quot;&quot;</span>

    <span class="c1"># Mutual Information Score</span>
    <span class="n">mi_scores</span> <span class="o">=</span> <span class="n">mutual_info_regression</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">42</span><span class="p">)</span>

    <span class="c1"># Feature-Wichtigkeit sortieren</span>
    <span class="n">feature_importance</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span>
        <span class="s1">&#39;feature&#39;</span><span class="p">:</span> <span class="n">X</span><span class="o">.</span><span class="n">columns</span><span class="p">,</span>
        <span class="s1">&#39;importance&#39;</span><span class="p">:</span> <span class="n">mi_scores</span>
    <span class="p">})</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="s1">&#39;importance&#39;</span><span class="p">,</span> <span class="n">ascending</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Top 10 wichtigste Tarifierungsmerkmale:&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">feature_importance</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">10</span><span class="p">))</span>

    <span class="k">return</span> <span class="n">feature_importance</span>
</code></pre></div>

<h3 id="34-pramienmodellierung">3.4 Pr√§mienmodellierung</h3>
<h4 id="341-generalisiertes-lineares-modell-glm">3.4.1 Generalisiertes Lineares Modell (GLM)</h4>
<p>GLM ist Standard in der Versicherungstarifierung.</p>
<div class="codehilite"><pre><span></span><code><span class="kn">import</span><span class="w"> </span><span class="nn">statsmodels.api</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">sm</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">statsmodels.genmod</span><span class="w"> </span><span class="kn">import</span> <span class="n">families</span><span class="p">,</span> <span class="n">links</span>

<span class="k">def</span><span class="w"> </span><span class="nf">build_glm_premium_model</span><span class="p">(</span><span class="n">df</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;GLM-Modell f√ºr Pr√§mienkalkulation&quot;&quot;&quot;</span>

    <span class="c1"># Zielvariable: Pr√§mie (oder Schadenkosten)</span>
    <span class="n">y</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;praemie&#39;</span><span class="p">]</span>

    <span class="c1"># Features</span>
    <span class="n">X</span> <span class="o">=</span> <span class="n">df</span><span class="p">[[</span><span class="s1">&#39;objekttyp&#39;</span><span class="p">,</span> <span class="s1">&#39;region&#39;</span><span class="p">,</span> <span class="s1">&#39;wohnflaeche&#39;</span><span class="p">,</span> <span class="s1">&#39;versicherungssumme&#39;</span><span class="p">,</span> 
            <span class="s1">&#39;baujahr&#39;</span><span class="p">,</span> <span class="s1">&#39;selbstbeteiligung&#39;</span><span class="p">,</span> <span class="s1">&#39;vertragsdauer&#39;</span><span class="p">]]</span>

    <span class="c1"># Dummies erstellen</span>
    <span class="n">X_encoded</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">get_dummies</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">drop_first</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">X_encoded</span> <span class="o">=</span> <span class="n">sm</span><span class="o">.</span><span class="n">add_constant</span><span class="p">(</span><span class="n">X_encoded</span><span class="p">)</span>

    <span class="c1"># GLM mit Gamma-Familie (f√ºr Pr√§mien/Schadenkosten)</span>
    <span class="c1"># Log-Link f√ºr multiplikative Effekte</span>
    <span class="n">glm_model</span> <span class="o">=</span> <span class="n">sm</span><span class="o">.</span><span class="n">GLM</span><span class="p">(</span>
        <span class="n">y</span><span class="p">,</span>
        <span class="n">X_encoded</span><span class="p">,</span>
        <span class="n">family</span><span class="o">=</span><span class="n">families</span><span class="o">.</span><span class="n">Gamma</span><span class="p">(</span><span class="n">link</span><span class="o">=</span><span class="n">links</span><span class="o">.</span><span class="n">log</span><span class="p">())</span>
    <span class="p">)</span>

    <span class="n">results</span> <span class="o">=</span> <span class="n">glm_model</span><span class="o">.</span><span class="n">fit</span><span class="p">()</span>

    <span class="nb">print</span><span class="p">(</span><span class="n">results</span><span class="o">.</span><span class="n">summary</span><span class="p">())</span>

    <span class="c1"># Pr√§mienvorhersage f√ºr neuen Vertrag</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">predict_premium</span><span class="p">(</span><span class="n">new_contract</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Pr√§mie f√ºr neuen Vertrag vorhersagen&quot;&quot;&quot;</span>
        <span class="n">new_X</span> <span class="o">=</span> <span class="n">prepare_features</span><span class="p">(</span><span class="n">new_contract</span><span class="p">)</span>
        <span class="n">premium</span> <span class="o">=</span> <span class="n">results</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">new_X</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">premium</span>

    <span class="k">return</span> <span class="n">results</span><span class="p">,</span> <span class="n">predict_premium</span>

<span class="c1"># Alternative: GAM (Generalized Additive Model)</span>
<span class="c1"># F√ºr nicht-lineare Zusammenh√§nge</span>
</code></pre></div>

<h4 id="342-xgboost-fur-tarifierung">3.4.2 XGBoost f√ºr Tarifierung</h4>
<p>Moderne ML-Ans√§tze k√∂nnen GLM erg√§nzen.</p>
<div class="codehilite"><pre><span></span><code><span class="kn">import</span><span class="w"> </span><span class="nn">xgboost</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">xgb</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">sklearn.model_selection</span><span class="w"> </span><span class="kn">import</span> <span class="n">train_test_split</span>

<span class="k">def</span><span class="w"> </span><span class="nf">build_xgboost_premium_model</span><span class="p">(</span><span class="n">df</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;XGBoost-Modell f√ºr Pr√§mienkalkulation&quot;&quot;&quot;</span>

    <span class="c1"># Features und Zielvariable</span>
    <span class="n">feature_cols</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;objekttyp&#39;</span><span class="p">,</span> <span class="s1">&#39;region&#39;</span><span class="p">,</span> <span class="s1">&#39;wohnflaeche&#39;</span><span class="p">,</span> <span class="s1">&#39;versicherungssumme&#39;</span><span class="p">,</span>
                    <span class="s1">&#39;baujahr&#39;</span><span class="p">,</span> <span class="s1">&#39;selbstbeteiligung&#39;</span><span class="p">,</span> <span class="s1">&#39;schadenhistorie_anzahl&#39;</span><span class="p">]</span>

    <span class="n">X</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">get_dummies</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="n">feature_cols</span><span class="p">])</span>
    <span class="n">y</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;praemie&#39;</span><span class="p">]</span>

    <span class="c1"># Train/Test Split</span>
    <span class="n">X_train</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">y_test</span> <span class="o">=</span> <span class="n">train_test_split</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">test_size</span><span class="o">=</span><span class="mf">0.2</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">42</span><span class="p">)</span>

    <span class="c1"># XGBoost Modell</span>
    <span class="n">model</span> <span class="o">=</span> <span class="n">xgb</span><span class="o">.</span><span class="n">XGBRegressor</span><span class="p">(</span>
        <span class="n">n_estimators</span><span class="o">=</span><span class="mi">200</span><span class="p">,</span>
        <span class="n">learning_rate</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span>
        <span class="n">max_depth</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span>
        <span class="n">objective</span><span class="o">=</span><span class="s1">&#39;reg:squarederror&#39;</span>
    <span class="p">)</span>

    <span class="n">model</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>

    <span class="c1"># Evaluation</span>
    <span class="n">train_pred</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_train</span><span class="p">)</span>
    <span class="n">test_pred</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>

    <span class="kn">from</span><span class="w"> </span><span class="nn">sklearn.metrics</span><span class="w"> </span><span class="kn">import</span> <span class="n">mean_absolute_error</span><span class="p">,</span> <span class="n">r2_score</span>

    <span class="n">train_mae</span> <span class="o">=</span> <span class="n">mean_absolute_error</span><span class="p">(</span><span class="n">y_train</span><span class="p">,</span> <span class="n">train_pred</span><span class="p">)</span>
    <span class="n">test_mae</span> <span class="o">=</span> <span class="n">mean_absolute_error</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">test_pred</span><span class="p">)</span>
    <span class="n">r2</span> <span class="o">=</span> <span class="n">r2_score</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">test_pred</span><span class="p">)</span>

    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Train MAE: ‚Ç¨</span><span class="si">{</span><span class="n">train_mae</span><span class="si">:</span><span class="s2">,.2f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Test MAE: ‚Ç¨</span><span class="si">{</span><span class="n">test_mae</span><span class="si">:</span><span class="s2">,.2f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;R¬≤ Score: </span><span class="si">{</span><span class="n">r2</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">model</span>
</code></pre></div>

<h3 id="35-tarifstrukturanalyse">3.5 Tarifstrukturanalyse</h3>
<div class="codehilite"><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">analyze_tariff_structure</span><span class="p">(</span><span class="n">df</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Tarifstruktur analysieren&quot;&quot;&quot;</span>

    <span class="c1"># Pr√§mie nach Risikogruppen</span>
    <span class="n">tariff_analysis</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">groupby</span><span class="p">([</span><span class="s1">&#39;objekttyp&#39;</span><span class="p">,</span> <span class="s1">&#39;region&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">agg</span><span class="p">({</span>
        <span class="s1">&#39;praemie&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;mean&#39;</span><span class="p">,</span> <span class="s1">&#39;median&#39;</span><span class="p">,</span> <span class="s1">&#39;std&#39;</span><span class="p">,</span> <span class="s1">&#39;count&#39;</span><span class="p">],</span>
        <span class="s1">&#39;schadenshoehe&#39;</span><span class="p">:</span> <span class="s1">&#39;mean&#39;</span><span class="p">,</span>
        <span class="s1">&#39;anzahl_schaeden&#39;</span><span class="p">:</span> <span class="s1">&#39;mean&#39;</span>
    <span class="p">})</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>

    <span class="c1"># Loss Ratio nach Tarifgruppe</span>
    <span class="n">df</span><span class="p">[</span><span class="s1">&#39;loss_ratio&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;schadenshoehe&#39;</span><span class="p">]</span> <span class="o">/</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;praemie&#39;</span><span class="p">]</span>

    <span class="n">loss_ratio_by_tariff</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">groupby</span><span class="p">([</span><span class="s1">&#39;objekttyp&#39;</span><span class="p">,</span> <span class="s1">&#39;region&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">agg</span><span class="p">({</span>
        <span class="s1">&#39;loss_ratio&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;mean&#39;</span><span class="p">,</span> <span class="s1">&#39;count&#39;</span><span class="p">],</span>
        <span class="s1">&#39;praemie&#39;</span><span class="p">:</span> <span class="s1">&#39;sum&#39;</span><span class="p">,</span>
        <span class="s1">&#39;schadenshoehe&#39;</span><span class="p">:</span> <span class="s1">&#39;sum&#39;</span>
    <span class="p">})</span>

    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Loss Ratio nach Tarifgruppe:&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">loss_ratio_by_tariff</span><span class="p">)</span>

    <span class="c1"># Tarifgruppen mit schlechter Performance identifizieren</span>
    <span class="n">problem_tariffs</span> <span class="o">=</span> <span class="n">loss_ratio_by_tariff</span><span class="p">[</span>
        <span class="n">loss_ratio_by_tariff</span><span class="p">[</span><span class="s1">&#39;loss_ratio&#39;</span><span class="p">][</span><span class="s1">&#39;mean&#39;</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mf">1.0</span>
    <span class="p">]</span>

    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Tarifgruppen mit Loss Ratio &gt; 100%:&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">problem_tariffs</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">tariff_analysis</span><span class="p">,</span> <span class="n">loss_ratio_by_tariff</span>
</code></pre></div>

<h3 id="36-anwendungsfalle-im-operativen-controlling">3.6 Anwendungsf√§lle im operativen Controlling</h3>
<ul>
<li><strong>Tarifanpassung</strong>: Identifikation von Unter-/√úbertarifierung</li>
<li><strong>Performance-Monitoring</strong>: Loss Ratio nach Tarifgruppen</li>
<li><strong>Marktpositionierung</strong>: Wettbewerbsanalyse der Pr√§mien</li>
<li><strong>Risikosegmentierung</strong>: Differenzierung nach Risikogruppen</li>
</ul>
<hr />
<h2 id="4-kennzahlensystem-von-schadensdaten">4. Kennzahlensystem von Schadensdaten</h2>
<h3 id="41-uberblick">4.1 √úberblick</h3>
<p>Ein Kennzahlensystem erm√∂glicht:
- <strong>Operatives Controlling</strong>: T√§gliches Monitoring der Schadenperformance
- <strong>Fr√ºherkennung</strong>: Trends und Anomalien schnell erkennen
- <strong>Steuerung</strong>: Entscheidungsgrundlage f√ºr Management
- <strong>Reporting</strong>: Strukturierte Berichterstattung</p>
<h3 id="42-zentrale-schaden-kennzahlen">4.2 Zentrale Schaden-Kennzahlen</h3>
<h4 id="421-haufigkeitskennzahlen">4.2.1 H√§ufigkeitskennzahlen</h4>
<h5 id="loss-frequency-rate-lfr">Loss Frequency Rate (LFR)</h5>
<p><strong>Formel</strong>: <code>Anzahl Sch√§den / Anzahl Versicherungsjahre</code></p>
<div class="codehilite"><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">calculate_loss_frequency_rate</span><span class="p">(</span><span class="n">df</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Loss Frequency Rate berechnen&quot;&quot;&quot;</span>

    <span class="n">total_claims</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;anzahl_schaeden&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
    <span class="n">total_exposure</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;anzahl_versicherungsjahre&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>

    <span class="n">lfr</span> <span class="o">=</span> <span class="n">total_claims</span> <span class="o">/</span> <span class="n">total_exposure</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Loss Frequency Rate: </span><span class="si">{</span><span class="n">lfr</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2"> Sch√§den pro Versicherungsjahr&quot;</span><span class="p">)</span>

    <span class="c1"># LFR nach Segmenten</span>
    <span class="n">lfr_by_segment</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;segment&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span>
        <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="p">[</span><span class="s1">&#39;anzahl_schaeden&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span> <span class="o">/</span> <span class="n">x</span><span class="p">[</span><span class="s1">&#39;anzahl_versicherungsjahre&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
    <span class="p">)</span>

    <span class="k">return</span> <span class="n">lfr</span><span class="p">,</span> <span class="n">lfr_by_segment</span>
</code></pre></div>

<h5 id="claim-frequency">Claim Frequency</h5>
<p><strong>Formel</strong>: <code>Anzahl Sch√§den / Anzahl Vertr√§ge</code></p>
<div class="codehilite"><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">calculate_claim_frequency</span><span class="p">(</span><span class="n">df</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Claim Frequency berechnen&quot;&quot;&quot;</span>

    <span class="n">total_claims</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;anzahl_schaeden&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
    <span class="n">total_policies</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>

    <span class="n">claim_freq</span> <span class="o">=</span> <span class="n">total_claims</span> <span class="o">/</span> <span class="n">total_policies</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Claim Frequency: </span><span class="si">{</span><span class="n">claim_freq</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2"> Sch√§den pro Vertrag&quot;</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">claim_freq</span>
</code></pre></div>

<h4 id="422-schwerekennzahlen">4.2.2 Schwerekennzahlen</h4>
<h5 id="average-loss-per-claim-alc">Average Loss per Claim (ALC)</h5>
<p><strong>Formel</strong>: <code>Gesamtschadenh√∂he / Anzahl Sch√§den</code></p>
<div class="codehilite"><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">calculate_average_loss_per_claim</span><span class="p">(</span><span class="n">df</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Durchschnittliche Schadenh√∂he pro Schadenfall&quot;&quot;&quot;</span>

    <span class="n">total_loss</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;schadenshoehe&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
    <span class="n">total_claims</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;anzahl_schaeden&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>

    <span class="n">alc</span> <span class="o">=</span> <span class="n">total_loss</span> <span class="o">/</span> <span class="n">total_claims</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Average Loss per Claim: ‚Ç¨</span><span class="si">{</span><span class="n">alc</span><span class="si">:</span><span class="s2">,.2f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="c1"># ALC nach Schadentyp</span>
    <span class="n">alc_by_type</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;schadentyp&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span>
        <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="p">[</span><span class="s1">&#39;schadenshoehe&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span> <span class="o">/</span> <span class="n">x</span><span class="p">[</span><span class="s1">&#39;anzahl_schaeden&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
    <span class="p">)</span>

    <span class="k">return</span> <span class="n">alc</span><span class="p">,</span> <span class="n">alc_by_type</span>
</code></pre></div>

<h5 id="average-loss-per-policy-alp">Average Loss per Policy (ALP)</h5>
<p><strong>Formel</strong>: <code>Gesamtschadenh√∂he / Anzahl Vertr√§ge</code></p>
<div class="codehilite"><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">calculate_average_loss_per_policy</span><span class="p">(</span><span class="n">df</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Durchschnittliche Schadenh√∂he pro Vertrag&quot;&quot;&quot;</span>

    <span class="n">total_loss</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;schadenshoehe&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
    <span class="n">total_policies</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>

    <span class="n">alp</span> <span class="o">=</span> <span class="n">total_loss</span> <span class="o">/</span> <span class="n">total_policies</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Average Loss per Policy: ‚Ç¨</span><span class="si">{</span><span class="n">alp</span><span class="si">:</span><span class="s2">,.2f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">alp</span>
</code></pre></div>

<h5 id="median-loss">Median Loss</h5>
<p>Wichtig f√ºr robuste Kennzahl (weniger anf√§llig f√ºr Ausrei√üer).</p>
<div class="codehilite"><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">calculate_median_loss</span><span class="p">(</span><span class="n">df</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Median-Schadenh√∂he&quot;&quot;&quot;</span>

    <span class="n">median_loss</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;schadenshoehe&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">median</span><span class="p">()</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Median Loss: ‚Ç¨</span><span class="si">{</span><span class="n">median_loss</span><span class="si">:</span><span class="s2">,.2f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="c1"># Vergleich Median vs. Mittelwert</span>
    <span class="n">mean_loss</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;schadenshoehe&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Mean Loss: ‚Ç¨</span><span class="si">{</span><span class="n">mean_loss</span><span class="si">:</span><span class="s2">,.2f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Differenz: ‚Ç¨</span><span class="si">{</span><span class="n">mean_loss</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">median_loss</span><span class="si">:</span><span class="s2">,.2f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">median_loss</span>
</code></pre></div>

<h4 id="423-kombinierte-kennzahlen">4.2.3 Kombinierte Kennzahlen</h4>
<h5 id="loss-ratio-schadenquote">Loss Ratio (Schadenquote)</h5>
<p><strong>Formel</strong>: <code>(Gesamtschadenh√∂he / Gesamtpr√§mien) √ó 100%</code></p>
<div class="codehilite"><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">calculate_loss_ratio</span><span class="p">(</span><span class="n">df</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Loss Ratio berechnen&quot;&quot;&quot;</span>

    <span class="n">total_loss</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;schadenshoehe&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
    <span class="n">total_premium</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;praemie&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>

    <span class="n">loss_ratio</span> <span class="o">=</span> <span class="p">(</span><span class="n">total_loss</span> <span class="o">/</span> <span class="n">total_premium</span><span class="p">)</span> <span class="o">*</span> <span class="mi">100</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Loss Ratio: </span><span class="si">{</span><span class="n">loss_ratio</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">%&quot;</span><span class="p">)</span>

    <span class="c1"># Loss Ratio Ziel: &lt; 100% (Versicherung macht Gewinn)</span>
    <span class="k">if</span> <span class="n">loss_ratio</span> <span class="o">&gt;</span> <span class="mi">100</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;‚ö†Ô∏è Warnung: Loss Ratio √ºber 100% - Verlust!&quot;</span><span class="p">)</span>

    <span class="c1"># Loss Ratio nach Segmenten</span>
    <span class="n">loss_ratio_by_segment</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;segment&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span>
        <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="s1">&#39;schadenshoehe&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span> <span class="o">/</span> <span class="n">x</span><span class="p">[</span><span class="s1">&#39;praemie&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">sum</span><span class="p">())</span> <span class="o">*</span> <span class="mi">100</span>
    <span class="p">)</span>

    <span class="k">return</span> <span class="n">loss_ratio</span><span class="p">,</span> <span class="n">loss_ratio_by_segment</span>
</code></pre></div>

<h5 id="combined-ratio">Combined Ratio</h5>
<p><strong>Formel</strong>: <code>Loss Ratio + Expense Ratio</code></p>
<div class="codehilite"><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">calculate_combined_ratio</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">total_expenses</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Combined Ratio berechnen&quot;&quot;&quot;</span>

    <span class="n">total_loss</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;schadenshoehe&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
    <span class="n">total_premium</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;praemie&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>

    <span class="n">loss_ratio</span> <span class="o">=</span> <span class="p">(</span><span class="n">total_loss</span> <span class="o">/</span> <span class="n">total_premium</span><span class="p">)</span> <span class="o">*</span> <span class="mi">100</span>
    <span class="n">expense_ratio</span> <span class="o">=</span> <span class="p">(</span><span class="n">total_expenses</span> <span class="o">/</span> <span class="n">total_premium</span><span class="p">)</span> <span class="o">*</span> <span class="mi">100</span>

    <span class="n">combined_ratio</span> <span class="o">=</span> <span class="n">loss_ratio</span> <span class="o">+</span> <span class="n">expense_ratio</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Loss Ratio: </span><span class="si">{</span><span class="n">loss_ratio</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">%&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Expense Ratio: </span><span class="si">{</span><span class="n">expense_ratio</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">%&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Combined Ratio: </span><span class="si">{</span><span class="n">combined_ratio</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">%&quot;</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">combined_ratio</span>
</code></pre></div>

<h4 id="424-weitere-wichtige-kennzahlen">4.2.4 Weitere wichtige Kennzahlen</h4>
<h5 id="claim-severity-index">Claim Severity Index</h5>
<p><strong>Formel</strong>: <code>(Aktuelle ALC / Historische ALC) √ó 100</code></p>
<div class="codehilite"><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">calculate_claim_severity_index</span><span class="p">(</span><span class="n">current_alc</span><span class="p">,</span> <span class="n">historical_alc</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Claim Severity Index - Trend in Schadenh√∂he&quot;&quot;&quot;</span>

    <span class="n">severity_index</span> <span class="o">=</span> <span class="p">(</span><span class="n">current_alc</span> <span class="o">/</span> <span class="n">historical_alc</span><span class="p">)</span> <span class="o">*</span> <span class="mi">100</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Claim Severity Index: </span><span class="si">{</span><span class="n">severity_index</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">severity_index</span> <span class="o">&gt;</span> <span class="mi">100</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;‚ö†Ô∏è Schadenh√∂hen steigen im Vergleich zur Historie&quot;</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">severity_index</span>
</code></pre></div>

<h5 id="ibnr-incurred-but-not-reported">IBNR (Incurred But Not Reported)</h5>
<p>Gesch√§tzte Sch√§den, die noch nicht gemeldet wurden.</p>
<div class="codehilite"><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">estimate_ibnr</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">development_factor</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    IBNR-Sch√§tzung</span>
<span class="sd">    development_factor: Faktor basierend auf historischen Daten</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">reported_claims</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;gemeldete_schaeden&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
    <span class="n">ibnr</span> <span class="o">=</span> <span class="n">reported_claims</span> <span class="o">*</span> <span class="n">development_factor</span>

    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Gemeldete Sch√§den: ‚Ç¨</span><span class="si">{</span><span class="n">reported_claims</span><span class="si">:</span><span class="s2">,.2f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Gesch√§tztes IBNR: ‚Ç¨</span><span class="si">{</span><span class="n">ibnr</span><span class="si">:</span><span class="s2">,.2f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Gesamtschaden (inkl. IBNR): ‚Ç¨</span><span class="si">{</span><span class="n">reported_claims</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">ibnr</span><span class="si">:</span><span class="s2">,.2f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">ibnr</span>
</code></pre></div>

<h3 id="43-dashboard-kennzahlen">4.3 Dashboard-Kennzahlen</h3>
<div class="codehilite"><pre><span></span><code><span class="kn">import</span><span class="w"> </span><span class="nn">pandas</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">pd</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">datetime</span><span class="w"> </span><span class="kn">import</span> <span class="n">datetime</span><span class="p">,</span> <span class="n">timedelta</span>

<span class="k">def</span><span class="w"> </span><span class="nf">create_schaden_dashboard</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">reporting_date</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Vollst√§ndiges Schaden-Dashboard erstellen&quot;&quot;&quot;</span>

    <span class="n">dashboard</span> <span class="o">=</span> <span class="p">{}</span>

    <span class="c1"># 1. √úbersichtskennzahlen</span>
    <span class="n">dashboard</span><span class="p">[</span><span class="s1">&#39;total_claims&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;anzahl_schaeden&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
    <span class="n">dashboard</span><span class="p">[</span><span class="s1">&#39;total_loss&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;schadenshoehe&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
    <span class="n">dashboard</span><span class="p">[</span><span class="s1">&#39;total_premium&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;praemie&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
    <span class="n">dashboard</span><span class="p">[</span><span class="s1">&#39;loss_ratio&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">dashboard</span><span class="p">[</span><span class="s1">&#39;total_loss&#39;</span><span class="p">]</span> <span class="o">/</span> <span class="n">dashboard</span><span class="p">[</span><span class="s1">&#39;total_premium&#39;</span><span class="p">])</span> <span class="o">*</span> <span class="mi">100</span>

    <span class="c1"># 2. H√§ufigkeitskennzahlen</span>
    <span class="n">total_exposure</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;anzahl_versicherungsjahre&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
    <span class="n">dashboard</span><span class="p">[</span><span class="s1">&#39;loss_frequency_rate&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">dashboard</span><span class="p">[</span><span class="s1">&#39;total_claims&#39;</span><span class="p">]</span> <span class="o">/</span> <span class="n">total_exposure</span>

    <span class="c1"># 3. Schwerekennzahlen</span>
    <span class="n">dashboard</span><span class="p">[</span><span class="s1">&#39;average_loss_per_claim&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">dashboard</span><span class="p">[</span><span class="s1">&#39;total_loss&#39;</span><span class="p">]</span> <span class="o">/</span> <span class="n">dashboard</span><span class="p">[</span><span class="s1">&#39;total_claims&#39;</span><span class="p">]</span>
    <span class="n">dashboard</span><span class="p">[</span><span class="s1">&#39;median_loss&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;schadenshoehe&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">median</span><span class="p">()</span>

    <span class="c1"># 4. Trends (vs. Vormonat/Vorjahr)</span>
    <span class="c1"># Hier w√ºrde man historische Daten vergleichen</span>

    <span class="c1"># 5. Segment-Analyse</span>
    <span class="n">segment_analysis</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;segment&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">agg</span><span class="p">({</span>
        <span class="s1">&#39;schadenshoehe&#39;</span><span class="p">:</span> <span class="s1">&#39;sum&#39;</span><span class="p">,</span>
        <span class="s1">&#39;praemie&#39;</span><span class="p">:</span> <span class="s1">&#39;sum&#39;</span><span class="p">,</span>
        <span class="s1">&#39;anzahl_schaeden&#39;</span><span class="p">:</span> <span class="s1">&#39;sum&#39;</span>
    <span class="p">})</span>
    <span class="n">segment_analysis</span><span class="p">[</span><span class="s1">&#39;loss_ratio&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span>
        <span class="n">segment_analysis</span><span class="p">[</span><span class="s1">&#39;schadenshoehe&#39;</span><span class="p">]</span> <span class="o">/</span> <span class="n">segment_analysis</span><span class="p">[</span><span class="s1">&#39;praemie&#39;</span><span class="p">]</span>
    <span class="p">)</span> <span class="o">*</span> <span class="mi">100</span>

    <span class="n">dashboard</span><span class="p">[</span><span class="s1">&#39;segment_analysis&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">segment_analysis</span>

    <span class="k">return</span> <span class="n">dashboard</span>

<span class="c1"># Visualisierung der Kennzahlen</span>
<span class="k">def</span><span class="w"> </span><span class="nf">visualize_kpis</span><span class="p">(</span><span class="n">df</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;KPIs visualisieren&quot;&quot;&quot;</span>

    <span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>
    <span class="kn">import</span><span class="w"> </span><span class="nn">seaborn</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">sns</span>

    <span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span> <span class="mi">12</span><span class="p">))</span>

    <span class="c1"># Loss Ratio Trend</span>
    <span class="n">df_monthly</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;datum&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">dt</span><span class="o">.</span><span class="n">to_period</span><span class="p">(</span><span class="s1">&#39;M&#39;</span><span class="p">))</span><span class="o">.</span><span class="n">agg</span><span class="p">({</span>
        <span class="s1">&#39;schadenshoehe&#39;</span><span class="p">:</span> <span class="s1">&#39;sum&#39;</span><span class="p">,</span>
        <span class="s1">&#39;praemie&#39;</span><span class="p">:</span> <span class="s1">&#39;sum&#39;</span>
    <span class="p">})</span>
    <span class="n">df_monthly</span><span class="p">[</span><span class="s1">&#39;loss_ratio&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">df_monthly</span><span class="p">[</span><span class="s1">&#39;schadenshoehe&#39;</span><span class="p">]</span> <span class="o">/</span> <span class="n">df_monthly</span><span class="p">[</span><span class="s1">&#39;praemie&#39;</span><span class="p">])</span> <span class="o">*</span> <span class="mi">100</span>

    <span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">df_monthly</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">str</span><span class="p">),</span> <span class="n">df_monthly</span><span class="p">[</span><span class="s1">&#39;loss_ratio&#39;</span><span class="p">])</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">axhline</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Break-even&#39;</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Loss Ratio Trend&#39;</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Loss Ratio (%)&#39;</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>

    <span class="c1"># Schadentyp-Verteilung</span>
    <span class="n">claim_type_dist</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;schadentyp&#39;</span><span class="p">)[</span><span class="s1">&#39;schadenshoehe&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">pie</span><span class="p">(</span><span class="n">claim_type_dist</span><span class="p">,</span> <span class="n">labels</span><span class="o">=</span><span class="n">claim_type_dist</span><span class="o">.</span><span class="n">index</span><span class="p">,</span> <span class="n">autopct</span><span class="o">=</span><span class="s1">&#39;</span><span class="si">%1.1f%%</span><span class="s1">&#39;</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Schadentyp-Verteilung (nach Volumen)&#39;</span><span class="p">)</span>

    <span class="c1"># Schadenh√∂hen-Verteilung</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;schadenshoehe&#39;</span><span class="p">],</span> <span class="n">bins</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span> <span class="n">edgecolor</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Verteilung der Schadenh√∂hen&#39;</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Schadenh√∂he (‚Ç¨)&#39;</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;H√§ufigkeit&#39;</span><span class="p">)</span>

    <span class="c1"># Loss Ratio nach Segmenten</span>
    <span class="n">segment_lr</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;segment&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span>
        <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="s1">&#39;schadenshoehe&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span> <span class="o">/</span> <span class="n">x</span><span class="p">[</span><span class="s1">&#39;praemie&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">sum</span><span class="p">())</span> <span class="o">*</span> <span class="mi">100</span>
    <span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">barh</span><span class="p">(</span><span class="n">segment_lr</span><span class="o">.</span><span class="n">index</span><span class="p">,</span> <span class="n">segment_lr</span><span class="o">.</span><span class="n">values</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Loss Ratio nach Segmenten&#39;</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Loss Ratio (%)&#39;</span><span class="p">)</span>

    <span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</code></pre></div>

<h3 id="44-anwendungsfalle-im-operativen-controlling">4.4 Anwendungsf√§lle im operativen Controlling</h3>
<ul>
<li><strong>T√§gliches Monitoring</strong>: Dashboards mit aktuellen Kennzahlen</li>
<li><strong>Fr√ºherkennung</strong>: Alerts bei Abweichungen</li>
<li><strong>Performance-Tracking</strong>: Vergleich von Soll/Ist</li>
<li><strong>Reporting</strong>: Monatliche/Quartalsberichte f√ºr Management</li>
</ul>
<hr />
<h2 id="5-messwerte-zur-modellguteprufung">5. Messwerte zur Modellg√ºtepr√ºfung</h2>
<h3 id="51-uberblick">5.1 √úberblick</h3>
<p>Modellg√ºtepr√ºfung ist essentiell f√ºr:
- <strong>Vertrauen in Modellergebnisse</strong>: Sind Vorhersagen zuverl√§ssig?
- <strong>Modellauswahl</strong>: Welches Modell ist am besten?
- <strong>Calibration</strong>: Stimmen Wahrscheinlichkeitsvorhersagen?
- <strong>Bias-Erkennung</strong>: Gibt es systematische Fehler?</p>
<h3 id="52-metriken-fur-klassifikation">5.2 Metriken f√ºr Klassifikation</h3>
<h4 id="521-confusion-matrix">5.2.1 Confusion Matrix</h4>
<p>Basis f√ºr viele Metriken.</p>
<div class="codehilite"><pre><span></span><code><span class="kn">from</span><span class="w"> </span><span class="nn">sklearn.metrics</span><span class="w"> </span><span class="kn">import</span> <span class="n">confusion_matrix</span><span class="p">,</span> <span class="n">classification_report</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">seaborn</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">sns</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>

<span class="k">def</span><span class="w"> </span><span class="nf">evaluate_classification_model</span><span class="p">(</span><span class="n">y_true</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">,</span> <span class="n">labels</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Klassifikationsmodell evaluieren&quot;&quot;&quot;</span>

    <span class="c1"># Confusion Matrix</span>
    <span class="n">cm</span> <span class="o">=</span> <span class="n">confusion_matrix</span><span class="p">(</span><span class="n">y_true</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">,</span> <span class="n">labels</span><span class="o">=</span><span class="n">labels</span><span class="p">)</span>

    <span class="c1"># Visualisierung</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">8</span><span class="p">))</span>
    <span class="n">sns</span><span class="o">.</span><span class="n">heatmap</span><span class="p">(</span><span class="n">cm</span><span class="p">,</span> <span class="n">annot</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">fmt</span><span class="o">=</span><span class="s1">&#39;d&#39;</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;Blues&#39;</span><span class="p">,</span> 
                <span class="n">xticklabels</span><span class="o">=</span><span class="n">labels</span><span class="p">,</span> <span class="n">yticklabels</span><span class="o">=</span><span class="n">labels</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Tats√§chliche Klasse&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Vorhergesagte Klasse&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Confusion Matrix&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

    <span class="c1"># Detaillierter Report</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">classification_report</span><span class="p">(</span><span class="n">y_true</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">,</span> <span class="n">labels</span><span class="o">=</span><span class="n">labels</span><span class="p">))</span>

    <span class="k">return</span> <span class="n">cm</span>
</code></pre></div>

<h4 id="522-accuracy-genauigkeit">5.2.2 Accuracy (Genauigkeit)</h4>
<p><strong>Formel</strong>: <code>(TP + TN) / (TP + TN + FP + FN)</code></p>
<div class="codehilite"><pre><span></span><code><span class="kn">from</span><span class="w"> </span><span class="nn">sklearn.metrics</span><span class="w"> </span><span class="kn">import</span> <span class="n">accuracy_score</span>

<span class="k">def</span><span class="w"> </span><span class="nf">calculate_accuracy</span><span class="p">(</span><span class="n">y_true</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Accuracy berechnen&quot;&quot;&quot;</span>

    <span class="n">accuracy</span> <span class="o">=</span> <span class="n">accuracy_score</span><span class="p">(</span><span class="n">y_true</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Accuracy: </span><span class="si">{</span><span class="n">accuracy</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2"> (</span><span class="si">{</span><span class="n">accuracy</span><span class="o">*</span><span class="mi">100</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">%)&quot;</span><span class="p">)</span>

    <span class="c1"># ‚ö†Ô∏è Vorsicht bei unbalancierten Klassen!</span>
    <span class="c1"># Bei unbalancierten Daten ist Accuracy oft irref√ºhrend</span>

    <span class="k">return</span> <span class="n">accuracy</span>
</code></pre></div>

<h4 id="523-precision-prazision">5.2.3 Precision (Pr√§zision)</h4>
<p><strong>Formel</strong>: <code>TP / (TP + FP)</code></p>
<p>Frage: Von den als positiv klassifizierten F√§llen, wie viele sind tats√§chlich positiv?</p>
<div class="codehilite"><pre><span></span><code><span class="kn">from</span><span class="w"> </span><span class="nn">sklearn.metrics</span><span class="w"> </span><span class="kn">import</span> <span class="n">precision_score</span>

<span class="k">def</span><span class="w"> </span><span class="nf">calculate_precision</span><span class="p">(</span><span class="n">y_true</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">,</span> <span class="n">average</span><span class="o">=</span><span class="s1">&#39;binary&#39;</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Precision berechnen&quot;&quot;&quot;</span>

    <span class="n">precision</span> <span class="o">=</span> <span class="n">precision_score</span><span class="p">(</span><span class="n">y_true</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">,</span> <span class="n">average</span><span class="o">=</span><span class="n">average</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">average</span> <span class="o">==</span> <span class="s1">&#39;binary&#39;</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Precision: </span><span class="si">{</span><span class="n">precision</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Precision (</span><span class="si">{</span><span class="n">average</span><span class="si">}</span><span class="s2">): </span><span class="si">{</span><span class="n">precision</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="c1"># Beispiel: Betrugserkennung</span>
    <span class="c1"># Hohe Precision = Wenige False Positives</span>
    <span class="c1"># Wichtig: Bearbeiter sollen nicht viele Falschmeldungen bekommen</span>

    <span class="k">return</span> <span class="n">precision</span>
</code></pre></div>

<h4 id="524-recall-sensitivitat-trefferquote">5.2.4 Recall (Sensitivit√§t, Trefferquote)</h4>
<p><strong>Formel</strong>: <code>TP / (TP + FN)</code></p>
<p>Frage: Von allen tats√§chlich positiven F√§llen, wie viele haben wir gefunden?</p>
<div class="codehilite"><pre><span></span><code><span class="kn">from</span><span class="w"> </span><span class="nn">sklearn.metrics</span><span class="w"> </span><span class="kn">import</span> <span class="n">recall_score</span>

<span class="k">def</span><span class="w"> </span><span class="nf">calculate_recall</span><span class="p">(</span><span class="n">y_true</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">,</span> <span class="n">average</span><span class="o">=</span><span class="s1">&#39;binary&#39;</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Recall berechnen&quot;&quot;&quot;</span>

    <span class="n">recall</span> <span class="o">=</span> <span class="n">recall_score</span><span class="p">(</span><span class="n">y_true</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">,</span> <span class="n">average</span><span class="o">=</span><span class="n">average</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">average</span> <span class="o">==</span> <span class="s1">&#39;binary&#39;</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Recall: </span><span class="si">{</span><span class="n">recall</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Recall (</span><span class="si">{</span><span class="n">average</span><span class="si">}</span><span class="s2">): </span><span class="si">{</span><span class="n">recall</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="c1"># Beispiel: Betrugserkennung</span>
    <span class="c1"># Hoher Recall = Wenige False Negatives</span>
    <span class="c1"># Wichtig: M√∂glichst viele Betrugsf√§lle sollen erkannt werden</span>

    <span class="k">return</span> <span class="n">recall</span>
</code></pre></div>

<h4 id="525-f1-score">5.2.5 F1-Score</h4>
<p><strong>Formel</strong>: <code>2 √ó (Precision √ó Recall) / (Precision + Recall)</code></p>
<p>Harmonisches Mittel aus Precision und Recall.</p>
<div class="codehilite"><pre><span></span><code><span class="kn">from</span><span class="w"> </span><span class="nn">sklearn.metrics</span><span class="w"> </span><span class="kn">import</span> <span class="n">f1_score</span>

<span class="k">def</span><span class="w"> </span><span class="nf">calculate_f1_score</span><span class="p">(</span><span class="n">y_true</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">,</span> <span class="n">average</span><span class="o">=</span><span class="s1">&#39;macro&#39;</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;F1-Score berechnen&quot;&quot;&quot;</span>

    <span class="n">f1</span> <span class="o">=</span> <span class="n">f1_score</span><span class="p">(</span><span class="n">y_true</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">,</span> <span class="n">average</span><span class="o">=</span><span class="n">average</span><span class="p">)</span>

    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;F1-Score (</span><span class="si">{</span><span class="n">average</span><span class="si">}</span><span class="s2">): </span><span class="si">{</span><span class="n">f1</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="c1"># F1-Score ist gut, wenn Precision und Recall beide wichtig sind</span>
    <span class="c1"># Macro: Durchschnitt √ºber alle Klassen (gilt f√ºr unbalancierte Klassen)</span>
    <span class="c1"># Weighted: Gewichtet nach Klassen-H√§ufigkeit</span>

    <span class="k">return</span> <span class="n">f1</span>
</code></pre></div>

<h4 id="526-roc-auc-receiver-operating-characteristic-area-under-curve">5.2.6 ROC-AUC (Receiver Operating Characteristic - Area Under Curve)</h4>
<p>Misst die F√§higkeit, zwischen Klassen zu unterscheiden.</p>
<div class="codehilite"><pre><span></span><code><span class="kn">from</span><span class="w"> </span><span class="nn">sklearn.metrics</span><span class="w"> </span><span class="kn">import</span> <span class="n">roc_auc_score</span><span class="p">,</span> <span class="n">roc_curve</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>

<span class="k">def</span><span class="w"> </span><span class="nf">evaluate_roc_auc</span><span class="p">(</span><span class="n">y_true</span><span class="p">,</span> <span class="n">y_pred_proba</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;ROC-AUC evaluieren&quot;&quot;&quot;</span>

    <span class="n">auc_score</span> <span class="o">=</span> <span class="n">roc_auc_score</span><span class="p">(</span><span class="n">y_true</span><span class="p">,</span> <span class="n">y_pred_proba</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;ROC-AUC Score: </span><span class="si">{</span><span class="n">auc_score</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="c1"># Interpretation:</span>
    <span class="c1"># 0.5 = Zuf√§llig (schlechtestes Modell)</span>
    <span class="c1"># 1.0 = Perfekt (bestes Modell)</span>
    <span class="c1"># &gt; 0.7 = Gute Diskriminationsf√§higkeit</span>
    <span class="c1"># &gt; 0.8 = Sehr gute Diskriminationsf√§higkeit</span>

    <span class="c1"># ROC Curve visualisieren</span>
    <span class="n">fpr</span><span class="p">,</span> <span class="n">tpr</span><span class="p">,</span> <span class="n">thresholds</span> <span class="o">=</span> <span class="n">roc_curve</span><span class="p">(</span><span class="n">y_true</span><span class="p">,</span> <span class="n">y_pred_proba</span><span class="p">)</span>

    <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">fpr</span><span class="p">,</span> <span class="n">tpr</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;ROC Curve (AUC = </span><span class="si">{</span><span class="n">auc_score</span><span class="si">:</span><span class="s1">.4f</span><span class="si">}</span><span class="s1">)&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="s1">&#39;k--&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Random Classifier&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;False Positive Rate&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;True Positive Rate&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;ROC Curve&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

    <span class="k">return</span> <span class="n">auc_score</span><span class="p">,</span> <span class="n">fpr</span><span class="p">,</span> <span class="n">tpr</span>
</code></pre></div>

<h4 id="527-precision-recall-curve">5.2.7 Precision-Recall Curve</h4>
<p>Besonders wichtig bei unbalancierten Klassen.</p>
<div class="codehilite"><pre><span></span><code><span class="kn">from</span><span class="w"> </span><span class="nn">sklearn.metrics</span><span class="w"> </span><span class="kn">import</span> <span class="n">precision_recall_curve</span><span class="p">,</span> <span class="n">average_precision_score</span>

<span class="k">def</span><span class="w"> </span><span class="nf">evaluate_precision_recall</span><span class="p">(</span><span class="n">y_true</span><span class="p">,</span> <span class="n">y_pred_proba</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Precision-Recall Curve evaluieren&quot;&quot;&quot;</span>

    <span class="n">precision</span><span class="p">,</span> <span class="n">recall</span><span class="p">,</span> <span class="n">thresholds</span> <span class="o">=</span> <span class="n">precision_recall_curve</span><span class="p">(</span><span class="n">y_true</span><span class="p">,</span> <span class="n">y_pred_proba</span><span class="p">)</span>
    <span class="n">avg_precision</span> <span class="o">=</span> <span class="n">average_precision_score</span><span class="p">(</span><span class="n">y_true</span><span class="p">,</span> <span class="n">y_pred_proba</span><span class="p">)</span>

    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Average Precision: </span><span class="si">{</span><span class="n">avg_precision</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="c1"># Visualisierung</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">recall</span><span class="p">,</span> <span class="n">precision</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;PR Curve (AP = </span><span class="si">{</span><span class="n">avg_precision</span><span class="si">:</span><span class="s1">.4f</span><span class="si">}</span><span class="s1">)&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Recall&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Precision&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Precision-Recall Curve&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

    <span class="k">return</span> <span class="n">precision</span><span class="p">,</span> <span class="n">recall</span><span class="p">,</span> <span class="n">avg_precision</span>
</code></pre></div>

<h4 id="528-brier-score">5.2.8 Brier Score</h4>
<p>F√ºr Wahrscheinlichkeitsvorhersagen (Calibration).</p>
<div class="codehilite"><pre><span></span><code><span class="kn">from</span><span class="w"> </span><span class="nn">sklearn.metrics</span><span class="w"> </span><span class="kn">import</span> <span class="n">brier_score_loss</span>

<span class="k">def</span><span class="w"> </span><span class="nf">calculate_brier_score</span><span class="p">(</span><span class="n">y_true</span><span class="p">,</span> <span class="n">y_pred_proba</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Brier Score berechnen (niedriger ist besser)&quot;&quot;&quot;</span>

    <span class="n">brier</span> <span class="o">=</span> <span class="n">brier_score_loss</span><span class="p">(</span><span class="n">y_true</span><span class="p">,</span> <span class="n">y_pred_proba</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Brier Score: </span><span class="si">{</span><span class="n">brier</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="c1"># Interpretation:</span>
    <span class="c1"># 0.0 = Perfekte Vorhersage</span>
    <span class="c1"># 0.25 = Zuf√§llige Vorhersage (f√ºr bin√§res Problem)</span>
    <span class="c1"># Niedriger = Besser</span>

    <span class="k">return</span> <span class="n">brier</span>
</code></pre></div>

<h3 id="53-metriken-fur-regression">5.3 Metriken f√ºr Regression</h3>
<h4 id="531-mae-mean-absolute-error">5.3.1 MAE (Mean Absolute Error)</h4>
<p><strong>Formel</strong>: <code>mean(|y_true - y_pred|)</code></p>
<div class="codehilite"><pre><span></span><code><span class="kn">from</span><span class="w"> </span><span class="nn">sklearn.metrics</span><span class="w"> </span><span class="kn">import</span> <span class="n">mean_absolute_error</span>

<span class="k">def</span><span class="w"> </span><span class="nf">calculate_mae</span><span class="p">(</span><span class="n">y_true</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Mean Absolute Error berechnen&quot;&quot;&quot;</span>

    <span class="n">mae</span> <span class="o">=</span> <span class="n">mean_absolute_error</span><span class="p">(</span><span class="n">y_true</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;MAE: ‚Ç¨</span><span class="si">{</span><span class="n">mae</span><span class="si">:</span><span class="s2">,.2f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="c1"># Interpretation: Durchschnittlicher Fehler in absoluten Werten</span>
    <span class="c1"># Beispiel: MAE von ‚Ç¨500 bedeutet, dass Vorhersage durchschnittlich</span>
    <span class="c1"># um ‚Ç¨500 vom tats√§chlichen Wert abweicht</span>

    <span class="k">return</span> <span class="n">mae</span>
</code></pre></div>

<h4 id="532-rmse-root-mean-squared-error">5.3.2 RMSE (Root Mean Squared Error)</h4>
<p><strong>Formel</strong>: <code>sqrt(mean((y_true - y_pred)¬≤))</code></p>
<div class="codehilite"><pre><span></span><code><span class="kn">from</span><span class="w"> </span><span class="nn">sklearn.metrics</span><span class="w"> </span><span class="kn">import</span> <span class="n">mean_squared_error</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>

<span class="k">def</span><span class="w"> </span><span class="nf">calculate_rmse</span><span class="p">(</span><span class="n">y_true</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Root Mean Squared Error berechnen&quot;&quot;&quot;</span>

    <span class="n">rmse</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">mean_squared_error</span><span class="p">(</span><span class="n">y_true</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">))</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;RMSE: ‚Ç¨</span><span class="si">{</span><span class="n">rmse</span><span class="si">:</span><span class="s2">,.2f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="c1"># RMSE bestraft gro√üe Fehler st√§rker als MAE</span>
    <span class="c1"># Gut f√ºr: Ausrei√üer sind wichtig (z.B. sehr hohe Sch√§den)</span>

    <span class="k">return</span> <span class="n">rmse</span>
</code></pre></div>

<h4 id="533-r2-score-determinationskoeffizient">5.3.3 R¬≤ Score (Determinationskoeffizient)</h4>
<p><strong>Formel</strong>: <code>1 - (SS_res / SS_tot)</code></p>
<div class="codehilite"><pre><span></span><code><span class="kn">from</span><span class="w"> </span><span class="nn">sklearn.metrics</span><span class="w"> </span><span class="kn">import</span> <span class="n">r2_score</span>

<span class="k">def</span><span class="w"> </span><span class="nf">calculate_r2_score</span><span class="p">(</span><span class="n">y_true</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;R¬≤ Score berechnen&quot;&quot;&quot;</span>

    <span class="n">r2</span> <span class="o">=</span> <span class="n">r2_score</span><span class="p">(</span><span class="n">y_true</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;R¬≤ Score: </span><span class="si">{</span><span class="n">r2</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="c1"># Interpretation:</span>
    <span class="c1"># 1.0 = Perfekte Vorhersage</span>
    <span class="c1"># 0.0 = Modell ist nicht besser als Mittelwert</span>
    <span class="c1"># &lt; 0.0 = Modell ist schlechter als Mittelwert</span>

    <span class="c1"># In der Versicherung:</span>
    <span class="c1"># R¬≤ &gt; 0.5 = Gutes Modell</span>
    <span class="c1"># R¬≤ &gt; 0.7 = Sehr gutes Modell</span>

    <span class="k">return</span> <span class="n">r2</span>
</code></pre></div>

<h4 id="534-mape-mean-absolute-percentage-error">5.3.4 MAPE (Mean Absolute Percentage Error)</h4>
<p><strong>Formel</strong>: <code>mean(|y_true - y_pred| / y_true) √ó 100%</code></p>
<div class="codehilite"><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">calculate_mape</span><span class="p">(</span><span class="n">y_true</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Mean Absolute Percentage Error berechnen&quot;&quot;&quot;</span>

    <span class="c1"># Vermeide Division durch Null</span>
    <span class="n">mask</span> <span class="o">=</span> <span class="n">y_true</span> <span class="o">!=</span> <span class="mi">0</span>
    <span class="n">mape</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">((</span><span class="n">y_true</span><span class="p">[</span><span class="n">mask</span><span class="p">]</span> <span class="o">-</span> <span class="n">y_pred</span><span class="p">[</span><span class="n">mask</span><span class="p">])</span> <span class="o">/</span> <span class="n">y_true</span><span class="p">[</span><span class="n">mask</span><span class="p">]))</span> <span class="o">*</span> <span class="mi">100</span>

    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;MAPE: </span><span class="si">{</span><span class="n">mape</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">%&quot;</span><span class="p">)</span>

    <span class="c1"># Interpretation: Durchschnittlicher prozentualer Fehler</span>
    <span class="c1"># Beispiel: MAPE von 15% bedeutet 15% Abweichung im Durchschnitt</span>

    <span class="k">return</span> <span class="n">mape</span>
</code></pre></div>

<h4 id="535-quantil-basierte-metriken">5.3.5 Quantil-basierte Metriken</h4>
<p>Wichtig f√ºr Versicherungen (z.B. VaR-Sch√§tzung).</p>
<div class="codehilite"><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">calculate_quantile_metrics</span><span class="p">(</span><span class="n">y_true</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">,</span> <span class="n">quantiles</span><span class="o">=</span><span class="p">[</span><span class="mf">0.25</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.75</span><span class="p">,</span> <span class="mf">0.95</span><span class="p">,</span> <span class="mf">0.99</span><span class="p">]):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Quantil-basierte Metriken&quot;&quot;&quot;</span>

    <span class="n">results</span> <span class="o">=</span> <span class="p">{}</span>

    <span class="k">for</span> <span class="n">q</span> <span class="ow">in</span> <span class="n">quantiles</span><span class="p">:</span>
        <span class="c1"># Tats√§chliches Quantil</span>
        <span class="n">true_quantile</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">quantile</span><span class="p">(</span><span class="n">y_true</span><span class="p">,</span> <span class="n">q</span><span class="p">)</span>

        <span class="c1"># Vorhergesagtes Quantil</span>
        <span class="n">pred_quantile</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">quantile</span><span class="p">(</span><span class="n">y_pred</span><span class="p">,</span> <span class="n">q</span><span class="p">)</span>

        <span class="c1"># Fehler</span>
        <span class="n">error</span> <span class="o">=</span> <span class="nb">abs</span><span class="p">(</span><span class="n">true_quantile</span> <span class="o">-</span> <span class="n">pred_quantile</span><span class="p">)</span>
        <span class="n">pct_error</span> <span class="o">=</span> <span class="p">(</span><span class="n">error</span> <span class="o">/</span> <span class="n">true_quantile</span><span class="p">)</span> <span class="o">*</span> <span class="mi">100</span> <span class="k">if</span> <span class="n">true_quantile</span> <span class="o">!=</span> <span class="mi">0</span> <span class="k">else</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span>

        <span class="n">results</span><span class="p">[</span><span class="n">q</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s1">&#39;true_quantile&#39;</span><span class="p">:</span> <span class="n">true_quantile</span><span class="p">,</span>
            <span class="s1">&#39;pred_quantile&#39;</span><span class="p">:</span> <span class="n">pred_quantile</span><span class="p">,</span>
            <span class="s1">&#39;error&#39;</span><span class="p">:</span> <span class="n">error</span><span class="p">,</span>
            <span class="s1">&#39;pct_error&#39;</span><span class="p">:</span> <span class="n">pct_error</span>
        <span class="p">}</span>

        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Quantil </span><span class="si">{</span><span class="n">q</span><span class="o">*</span><span class="mi">100</span><span class="si">:</span><span class="s2">.0f</span><span class="si">}</span><span class="s2">%: &quot;</span>
              <span class="sa">f</span><span class="s2">&quot;Tats√§chlich ‚Ç¨</span><span class="si">{</span><span class="n">true_quantile</span><span class="si">:</span><span class="s2">,.2f</span><span class="si">}</span><span class="s2">, &quot;</span>
              <span class="sa">f</span><span class="s2">&quot;Vorhergesagt ‚Ç¨</span><span class="si">{</span><span class="n">pred_quantile</span><span class="si">:</span><span class="s2">,.2f</span><span class="si">}</span><span class="s2">, &quot;</span>
              <span class="sa">f</span><span class="s2">&quot;Fehler: </span><span class="si">{</span><span class="n">pct_error</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">%&quot;</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">results</span>
</code></pre></div>

<h3 id="54-cross-validation">5.4 Cross-Validation</h3>
<h4 id="541-k-fold-cross-validation">5.4.1 K-Fold Cross-Validation</h4>
<p>Robuste Modellg√ºtepr√ºfung.</p>
<div class="codehilite"><pre><span></span><code><span class="kn">from</span><span class="w"> </span><span class="nn">sklearn.model_selection</span><span class="w"> </span><span class="kn">import</span> <span class="n">cross_val_score</span><span class="p">,</span> <span class="n">KFold</span>

<span class="k">def</span><span class="w"> </span><span class="nf">perform_cross_validation</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">cv</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">scoring</span><span class="o">=</span><span class="s1">&#39;neg_mean_squared_error&#39;</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;K-Fold Cross-Validation durchf√ºhren&quot;&quot;&quot;</span>

    <span class="n">cv_scores</span> <span class="o">=</span> <span class="n">cross_val_score</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">cv</span><span class="o">=</span><span class="n">cv</span><span class="p">,</span> <span class="n">scoring</span><span class="o">=</span><span class="n">scoring</span><span class="p">)</span>

    <span class="c1"># Negate f√ºr MAE/RMSE (weil sklearn negative Scores zur√ºckgibt)</span>
    <span class="k">if</span> <span class="s1">&#39;neg&#39;</span> <span class="ow">in</span> <span class="n">scoring</span><span class="p">:</span>
        <span class="n">cv_scores</span> <span class="o">=</span> <span class="o">-</span><span class="n">cv_scores</span>

    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Cross-Validation Scores (</span><span class="si">{</span><span class="n">cv</span><span class="si">}</span><span class="s2">-fold):&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  Mean: </span><span class="si">{</span><span class="n">cv_scores</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  Std: </span><span class="si">{</span><span class="n">cv_scores</span><span class="o">.</span><span class="n">std</span><span class="p">()</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  Min: </span><span class="si">{</span><span class="n">cv_scores</span><span class="o">.</span><span class="n">min</span><span class="p">()</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  Max: </span><span class="si">{</span><span class="n">cv_scores</span><span class="o">.</span><span class="n">max</span><span class="p">()</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">cv_scores</span>
</code></pre></div>

<h4 id="542-time-series-cross-validation">5.4.2 Time Series Cross-Validation</h4>
<p>F√ºr zeitliche Daten wichtig.</p>
<div class="codehilite"><pre><span></span><code><span class="kn">from</span><span class="w"> </span><span class="nn">sklearn.model_selection</span><span class="w"> </span><span class="kn">import</span> <span class="n">TimeSeriesSplit</span>

<span class="k">def</span><span class="w"> </span><span class="nf">perform_time_series_cv</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">n_splits</span><span class="o">=</span><span class="mi">5</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Time Series Cross-Validation&quot;&quot;&quot;</span>

    <span class="n">tscv</span> <span class="o">=</span> <span class="n">TimeSeriesSplit</span><span class="p">(</span><span class="n">n_splits</span><span class="o">=</span><span class="n">n_splits</span><span class="p">)</span>
    <span class="n">scores</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="k">for</span> <span class="n">train_idx</span><span class="p">,</span> <span class="n">test_idx</span> <span class="ow">in</span> <span class="n">tscv</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="n">X</span><span class="p">):</span>
        <span class="n">X_train</span><span class="p">,</span> <span class="n">X_test</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">train_idx</span><span class="p">],</span> <span class="n">X</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">test_idx</span><span class="p">]</span>
        <span class="n">y_train</span><span class="p">,</span> <span class="n">y_test</span> <span class="o">=</span> <span class="n">y</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">train_idx</span><span class="p">],</span> <span class="n">y</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">test_idx</span><span class="p">]</span>

        <span class="n">model</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>
        <span class="n">score</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">score</span><span class="p">(</span><span class="n">X_test</span><span class="p">,</span> <span class="n">y_test</span><span class="p">)</span>
        <span class="n">scores</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">score</span><span class="p">)</span>

    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Time Series CV Scores:&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  Mean: </span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">scores</span><span class="p">)</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  Std: </span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="n">scores</span><span class="p">)</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">scores</span>
</code></pre></div>

<h3 id="55-residual-analyse">5.5 Residual-Analyse</h3>
<div class="codehilite"><pre><span></span><code><span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">seaborn</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">sns</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">scipy</span><span class="w"> </span><span class="kn">import</span> <span class="n">stats</span>

<span class="k">def</span><span class="w"> </span><span class="nf">analyze_residuals</span><span class="p">(</span><span class="n">y_true</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Residual-Analyse durchf√ºhren&quot;&quot;&quot;</span>

    <span class="n">residuals</span> <span class="o">=</span> <span class="n">y_true</span> <span class="o">-</span> <span class="n">y_pred</span>

    <span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span> <span class="mi">12</span><span class="p">))</span>

    <span class="c1"># 1. Residual-Verteilung</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">residuals</span><span class="p">,</span> <span class="n">bins</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span> <span class="n">edgecolor</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Verteilung der Residuals&#39;</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Residual&#39;</span><span class="p">)</span>

    <span class="c1"># 2. Q-Q Plot (Normalverteilung pr√ºfen)</span>
    <span class="n">stats</span><span class="o">.</span><span class="n">probplot</span><span class="p">(</span><span class="n">residuals</span><span class="p">,</span> <span class="n">dist</span><span class="o">=</span><span class="s2">&quot;norm&quot;</span><span class="p">,</span> <span class="n">plot</span><span class="o">=</span><span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Q-Q Plot (Normalverteilung)&#39;</span><span class="p">)</span>

    <span class="c1"># 3. Residuals vs. Predicted</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">y_pred</span><span class="p">,</span> <span class="n">residuals</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">axhline</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Vorhergesagte Werte&#39;</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Residuals&#39;</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Residuals vs. Predicted&#39;</span><span class="p">)</span>

    <span class="c1"># 4. Residuals vs. Index (Zeit, falls vorhanden)</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">residuals</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">axhline</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Index&#39;</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Residuals&#39;</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Residuals √ºber Zeit&#39;</span><span class="p">)</span>

    <span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

    <span class="c1"># Statistische Tests</span>
    <span class="c1"># Shapiro-Wilk Test f√ºr Normalverteilung</span>
    <span class="n">stat</span><span class="p">,</span> <span class="n">p_value</span> <span class="o">=</span> <span class="n">stats</span><span class="o">.</span><span class="n">shapiro</span><span class="p">(</span><span class="n">residuals</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Shapiro-Wilk Test f√ºr Normalverteilung:&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  Statistic: </span><span class="si">{</span><span class="n">stat</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  p-value: </span><span class="si">{</span><span class="n">p_value</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">p_value</span> <span class="o">&gt;</span> <span class="mf">0.05</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;  Residuals sind normalverteilt ‚úì&quot;</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;  Residuals sind NICHT normalverteilt ‚úó&quot;</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">residuals</span>
</code></pre></div>

<h3 id="56-calibration-kalibrierung">5.6 Calibration (Kalibrierung)</h3>
<div class="codehilite"><pre><span></span><code><span class="kn">from</span><span class="w"> </span><span class="nn">sklearn.calibration</span><span class="w"> </span><span class="kn">import</span> <span class="n">calibration_curve</span><span class="p">,</span> <span class="n">CalibratedClassifierCV</span>

<span class="k">def</span><span class="w"> </span><span class="nf">evaluate_calibration</span><span class="p">(</span><span class="n">y_true</span><span class="p">,</span> <span class="n">y_pred_proba</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Calibration des Modells pr√ºfen&quot;&quot;&quot;</span>

    <span class="n">fraction_of_positives</span><span class="p">,</span> <span class="n">mean_predicted_value</span> <span class="o">=</span> <span class="n">calibration_curve</span><span class="p">(</span>
        <span class="n">y_true</span><span class="p">,</span> <span class="n">y_pred_proba</span><span class="p">,</span> <span class="n">n_bins</span><span class="o">=</span><span class="mi">10</span>
    <span class="p">)</span>

    <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">mean_predicted_value</span><span class="p">,</span> <span class="n">fraction_of_positives</span><span class="p">,</span> <span class="s2">&quot;s-&quot;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Modell&quot;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="s2">&quot;k:&quot;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Perfekt kalibriert&quot;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;Tats√§chlicher Anteil Positiver&quot;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;Vorhergesagte Wahrscheinlichkeit&quot;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;Calibration Plot&quot;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

    <span class="c1"># Calibration verbessern mit Platt Scaling oder Isotonic Regression</span>
    <span class="n">calibrated_model</span> <span class="o">=</span> <span class="n">CalibratedClassifierCV</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="s1">&#39;isotonic&#39;</span><span class="p">,</span> <span class="n">cv</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
    <span class="n">calibrated_model</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">calibrated_model</span>
</code></pre></div>

<h3 id="57-modellvergleich">5.7 Modellvergleich</h3>
<div class="codehilite"><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">compare_models</span><span class="p">(</span><span class="n">models_dict</span><span class="p">,</span> <span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Verschiedene Modelle vergleichen&quot;&quot;&quot;</span>

    <span class="n">results</span> <span class="o">=</span> <span class="p">{}</span>

    <span class="k">for</span> <span class="n">name</span><span class="p">,</span> <span class="n">model</span> <span class="ow">in</span> <span class="n">models_dict</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
        <span class="c1"># Cross-Validation Scores</span>
        <span class="n">cv_scores</span> <span class="o">=</span> <span class="n">cross_val_score</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">cv</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">scoring</span><span class="o">=</span><span class="s1">&#39;neg_mean_squared_error&#39;</span><span class="p">)</span>

        <span class="n">results</span><span class="p">[</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s1">&#39;mean_cv_score&#39;</span><span class="p">:</span> <span class="o">-</span><span class="n">cv_scores</span><span class="o">.</span><span class="n">mean</span><span class="p">(),</span>
            <span class="s1">&#39;std_cv_score&#39;</span><span class="p">:</span> <span class="n">cv_scores</span><span class="o">.</span><span class="n">std</span><span class="p">(),</span>
            <span class="s1">&#39;min_cv_score&#39;</span><span class="p">:</span> <span class="o">-</span><span class="n">cv_scores</span><span class="o">.</span><span class="n">max</span><span class="p">(),</span>
            <span class="s1">&#39;max_cv_score&#39;</span><span class="p">:</span> <span class="o">-</span><span class="n">cv_scores</span><span class="o">.</span><span class="n">min</span><span class="p">()</span>
        <span class="p">}</span>

        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="si">{</span><span class="n">name</span><span class="si">}</span><span class="s2">:&quot;</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  Mean CV Score: </span><span class="si">{</span><span class="n">results</span><span class="p">[</span><span class="n">name</span><span class="p">][</span><span class="s1">&#39;mean_cv_score&#39;</span><span class="p">]</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  Std CV Score: </span><span class="si">{</span><span class="n">results</span><span class="p">[</span><span class="n">name</span><span class="p">][</span><span class="s1">&#39;std_cv_score&#39;</span><span class="p">]</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="c1"># Bestes Modell finden</span>
    <span class="n">best_model</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">results</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">results</span><span class="p">[</span><span class="n">x</span><span class="p">][</span><span class="s1">&#39;mean_cv_score&#39;</span><span class="p">])</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Bestes Modell: </span><span class="si">{</span><span class="n">best_model</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">results</span><span class="p">,</span> <span class="n">best_model</span>
</code></pre></div>

<h3 id="58-anwendungsfalle-im-operativen-controlling">5.8 Anwendungsf√§lle im operativen Controlling</h3>
<ul>
<li><strong>Modellvalidierung</strong>: Regelm√§√üige Pr√ºfung der Modellg√ºte</li>
<li><strong>Modellauswahl</strong>: Vergleich verschiedener Ans√§tze</li>
<li><strong>Monitoring</strong>: Tracking der Modellperformance √ºber Zeit</li>
<li><strong>Reporting</strong>: Dokumentation f√ºr Regulatoren/Audit</li>
</ul>
<hr />
<h2 id="6-operatives-controlling-in-der-sachversicherung">6. Operatives Controlling in der Sachversicherung</h2>
<h3 id="61-aufgaben-und-ziele">6.1 Aufgaben und Ziele</h3>
<h4 id="611-hauptaufgaben">6.1.1 Hauptaufgaben</h4>
<ul>
<li><strong>Schadenmonitoring</strong>: Kontinuierliche √úberwachung der Schadenentwicklung</li>
<li><strong>Fr√ºhwarnsystem</strong>: Identifikation von Abweichungen und Risiken</li>
<li><strong>Performance-Messung</strong>: Evaluation von Tarifen, Produkten, Segmenten</li>
<li><strong>Reservierung</strong>: Statistische Schadensreserven</li>
</ul>
<h4 id="612-ziele">6.1.2 Ziele</h4>
<ul>
<li><strong>Kostensteuerung</strong>: Verlustquoten kontrollieren</li>
<li><strong>Risikofr√ºherkennung</strong>: Trends rechtzeitig erkennen</li>
<li><strong>Entscheidungsunterst√ºtzung</strong>: Datenbasierte Empfehlungen</li>
<li><strong>Compliance</strong>: Regulatorische Anforderungen erf√ºllen</li>
</ul>
<h3 id="62-typische-analysen">6.2 Typische Analysen</h3>
<h4 id="621-schaden-trend-analyse">6.2.1 Schaden-Trend-Analyse</h4>
<div class="codehilite"><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">analyze_claim_trends</span><span class="p">(</span><span class="n">df</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Schaden-Trends analysieren&quot;&quot;&quot;</span>

    <span class="c1"># Zeitliche Entwicklung</span>
    <span class="n">monthly_trends</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;datum&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">dt</span><span class="o">.</span><span class="n">to_period</span><span class="p">(</span><span class="s1">&#39;M&#39;</span><span class="p">))</span><span class="o">.</span><span class="n">agg</span><span class="p">({</span>
        <span class="s1">&#39;anzahl_schaeden&#39;</span><span class="p">:</span> <span class="s1">&#39;sum&#39;</span><span class="p">,</span>
        <span class="s1">&#39;schadenshoehe&#39;</span><span class="p">:</span> <span class="s1">&#39;sum&#39;</span><span class="p">,</span>
        <span class="s1">&#39;praemie&#39;</span><span class="p">:</span> <span class="s1">&#39;sum&#39;</span>
    <span class="p">})</span>

    <span class="n">monthly_trends</span><span class="p">[</span><span class="s1">&#39;loss_ratio&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span>
        <span class="n">monthly_trends</span><span class="p">[</span><span class="s1">&#39;schadenshoehe&#39;</span><span class="p">]</span> <span class="o">/</span> <span class="n">monthly_trends</span><span class="p">[</span><span class="s1">&#39;praemie&#39;</span><span class="p">]</span>
    <span class="p">)</span> <span class="o">*</span> <span class="mi">100</span>

    <span class="c1"># Trend-Detection</span>
    <span class="kn">from</span><span class="w"> </span><span class="nn">scipy</span><span class="w"> </span><span class="kn">import</span> <span class="n">stats</span>

    <span class="c1"># Linearer Trend testen</span>
    <span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">monthly_trends</span><span class="p">))</span>
    <span class="n">slope</span><span class="p">,</span> <span class="n">intercept</span><span class="p">,</span> <span class="n">r_value</span><span class="p">,</span> <span class="n">p_value</span><span class="p">,</span> <span class="n">std_err</span> <span class="o">=</span> <span class="n">stats</span><span class="o">.</span><span class="n">linregress</span><span class="p">(</span>
        <span class="n">x</span><span class="p">,</span> <span class="n">monthly_trends</span><span class="p">[</span><span class="s1">&#39;loss_ratio&#39;</span><span class="p">]</span>
    <span class="p">)</span>

    <span class="k">if</span> <span class="n">p_value</span> <span class="o">&lt;</span> <span class="mf">0.05</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">slope</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;‚ö†Ô∏è Signifikanter Anstieg in Loss Ratio!&quot;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;‚úì Loss Ratio sinkt signifikant&quot;</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">monthly_trends</span>
</code></pre></div>

<h4 id="622-segment-performance">6.2.2 Segment-Performance</h4>
<div class="codehilite"><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">analyze_segment_performance</span><span class="p">(</span><span class="n">df</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Performance nach Segmenten analysieren&quot;&quot;&quot;</span>

    <span class="n">segment_perf</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;segment&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">agg</span><span class="p">({</span>
        <span class="s1">&#39;praemie&#39;</span><span class="p">:</span> <span class="s1">&#39;sum&#39;</span><span class="p">,</span>
        <span class="s1">&#39;schadenshoehe&#39;</span><span class="p">:</span> <span class="s1">&#39;sum&#39;</span><span class="p">,</span>
        <span class="s1">&#39;anzahl_schaeden&#39;</span><span class="p">:</span> <span class="s1">&#39;sum&#39;</span><span class="p">,</span>
        <span class="s1">&#39;versicherungssumme&#39;</span><span class="p">:</span> <span class="s1">&#39;sum&#39;</span>
    <span class="p">})</span>

    <span class="n">segment_perf</span><span class="p">[</span><span class="s1">&#39;loss_ratio&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span>
        <span class="n">segment_perf</span><span class="p">[</span><span class="s1">&#39;schadenshoehe&#39;</span><span class="p">]</span> <span class="o">/</span> <span class="n">segment_perf</span><span class="p">[</span><span class="s1">&#39;praemie&#39;</span><span class="p">]</span>
    <span class="p">)</span> <span class="o">*</span> <span class="mi">100</span>

    <span class="n">segment_perf</span><span class="p">[</span><span class="s1">&#39;schadenquote&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span>
        <span class="n">segment_perf</span><span class="p">[</span><span class="s1">&#39;anzahl_schaeden&#39;</span><span class="p">]</span> <span class="o">/</span> <span class="nb">len</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
    <span class="p">)</span> <span class="o">*</span> <span class="mi">100</span>

    <span class="c1"># Problemsegmente identifizieren</span>
    <span class="n">problem_segments</span> <span class="o">=</span> <span class="n">segment_perf</span><span class="p">[</span><span class="n">segment_perf</span><span class="p">[</span><span class="s1">&#39;loss_ratio&#39;</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">100</span><span class="p">]</span>

    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Problemsegmente (Loss Ratio &gt; 100%):&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">problem_segments</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">segment_perf</span>
</code></pre></div>

<h3 id="63-reporting-framework">6.3 Reporting-Framework</h3>
<div class="codehilite"><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">create_monthly_report</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">reporting_month</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Monatliches Controlling-Report erstellen&quot;&quot;&quot;</span>

    <span class="n">report</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s1">&#39;reporting_date&#39;</span><span class="p">:</span> <span class="n">reporting_month</span><span class="p">,</span>
        <span class="s1">&#39;overview&#39;</span><span class="p">:</span> <span class="p">{},</span>
        <span class="s1">&#39;segments&#39;</span><span class="p">:</span> <span class="p">{},</span>
        <span class="s1">&#39;trends&#39;</span><span class="p">:</span> <span class="p">{},</span>
        <span class="s1">&#39;alerts&#39;</span><span class="p">:</span> <span class="p">[]</span>
    <span class="p">}</span>

    <span class="c1"># √úbersicht</span>
    <span class="n">report</span><span class="p">[</span><span class="s1">&#39;overview&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s1">&#39;total_premium&#39;</span><span class="p">:</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;praemie&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">sum</span><span class="p">(),</span>
        <span class="s1">&#39;total_loss&#39;</span><span class="p">:</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;schadenshoehe&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">sum</span><span class="p">(),</span>
        <span class="s1">&#39;loss_ratio&#39;</span><span class="p">:</span> <span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;schadenshoehe&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span> <span class="o">/</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;praemie&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">sum</span><span class="p">())</span> <span class="o">*</span> <span class="mi">100</span><span class="p">,</span>
        <span class="s1">&#39;total_claims&#39;</span><span class="p">:</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;anzahl_schaeden&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">sum</span><span class="p">(),</span>
        <span class="s1">&#39;avg_claim_size&#39;</span><span class="p">:</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;schadenshoehe&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span> <span class="o">/</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;anzahl_schaeden&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
    <span class="p">}</span>

    <span class="c1"># Alerts</span>
    <span class="k">if</span> <span class="n">report</span><span class="p">[</span><span class="s1">&#39;overview&#39;</span><span class="p">][</span><span class="s1">&#39;loss_ratio&#39;</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">100</span><span class="p">:</span>
        <span class="n">report</span><span class="p">[</span><span class="s1">&#39;alerts&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">({</span>
            <span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="s1">&#39;CRITICAL&#39;</span><span class="p">,</span>
            <span class="s1">&#39;message&#39;</span><span class="p">:</span> <span class="sa">f</span><span class="s2">&quot;Loss Ratio √ºber 100%: </span><span class="si">{</span><span class="n">report</span><span class="p">[</span><span class="s1">&#39;overview&#39;</span><span class="p">][</span><span class="s1">&#39;loss_ratio&#39;</span><span class="p">]</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">%&quot;</span>
        <span class="p">})</span>

    <span class="k">if</span> <span class="n">report</span><span class="p">[</span><span class="s1">&#39;overview&#39;</span><span class="p">][</span><span class="s1">&#39;avg_claim_size&#39;</span><span class="p">]</span> <span class="o">&gt;</span> <span class="n">historical_avg</span> <span class="o">*</span> <span class="mf">1.2</span><span class="p">:</span>
        <span class="n">report</span><span class="p">[</span><span class="s1">&#39;alerts&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">({</span>
            <span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="s1">&#39;WARNING&#39;</span><span class="p">,</span>
            <span class="s1">&#39;message&#39;</span><span class="p">:</span> <span class="sa">f</span><span class="s2">&quot;Durchschnittliche Schadenh√∂he um 20% √ºber historischem Wert&quot;</span>
        <span class="p">})</span>

    <span class="k">return</span> <span class="n">report</span>
</code></pre></div>

<hr />
<h2 id="7-case-study-vorbereitung">7. Case Study Vorbereitung</h2>
<h3 id="71-typische-case-study-szenarien">7.1 Typische Case Study Szenarien</h3>
<h4 id="711-schadenfalle-klassifizieren">7.1.1 Schadenf√§lle klassifizieren</h4>
<p><strong>Aufgabe</strong>: Entwickle ein Modell zur automatischen Klassifikation von Schadenf√§llen.</p>
<p><strong>L√∂sungsansatz</strong>:
1. Daten explorieren (Schadentypen, Verteilungen)
2. Features engineer (historische Daten, Objekteigenschaften)
3. Verschiedene Klassifikationsmodelle testen (Logistic Regression, Random Forest, XGBoost)
4. Evaluation mit Confusion Matrix, F1-Score, ROC-AUC
5. Feature Importance analysieren
6. Deployment-Strategie √ºberlegen</p>
<h4 id="712-loss-ratio-prognose">7.1.2 Loss Ratio Prognose</h4>
<p><strong>Aufgabe</strong>: Prognostiziere die Loss Ratio f√ºr das n√§chste Quartal.</p>
<p><strong>L√∂sungsansatz</strong>:
1. Zeitreihenanalyse (Trends, Saisonalit√§t)
2. Exogene Variablen identifizieren (Wetter, Marktdaten)
3. Time Series Modelle (ARIMA, Prophet, LSTM)
4. Regression-Modelle mit Features
5. Ensemble-Methoden
6. Backtesting</p>
<h4 id="713-tarifoptimierung">7.1.3 Tarifoptimierung</h4>
<p><strong>Aufgabe</strong>: Identifiziere Tarifgruppen mit Unter-/√úbertarifierung.</p>
<p><strong>L√∂sungsansatz</strong>:
1. Loss Ratio nach Tarifgruppen berechnen
2. Statistische Signifikanz testen
3. Erwartete vs. tats√§chliche Schadenkosten vergleichen
4. Anpassungsempfehlungen entwickeln
5. Impact-Analyse durchf√ºhren</p>
<h3 id="72-wichtige-python-skills-fur-case-study">7.2 Wichtige Python-Skills f√ºr Case Study</h3>
<div class="codehilite"><pre><span></span><code><span class="c1"># 1. Daten laden und explorieren</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">pandas</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">pd</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">seaborn</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">sns</span>

<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;schadensdaten.csv&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">info</span><span class="p">())</span>
<span class="nb">print</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">describe</span><span class="p">())</span>

<span class="c1"># 2. Datenaufbereitung</span>
<span class="c1"># Fehlende Werte, Outlier, Feature Engineering</span>

<span class="c1"># 3. Modellierung</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">sklearn.model_selection</span><span class="w"> </span><span class="kn">import</span> <span class="n">train_test_split</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">sklearn.preprocessing</span><span class="w"> </span><span class="kn">import</span> <span class="n">StandardScaler</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">sklearn.ensemble</span><span class="w"> </span><span class="kn">import</span> <span class="n">RandomForestClassifier</span>

<span class="c1"># 4. Evaluation</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">sklearn.metrics</span><span class="w"> </span><span class="kn">import</span> <span class="n">classification_report</span><span class="p">,</span> <span class="n">confusion_matrix</span>

<span class="c1"># 5. Visualisierung</span>
<span class="c1"># Wichtig f√ºr Pr√§sentation!</span>
</code></pre></div>

<h3 id="73-prasentationstipps">7.3 Pr√§sentationstipps</h3>
<ul>
<li><strong>Struktur</strong>: Problem ‚Üí L√∂sung ‚Üí Ergebnisse ‚Üí Interpretation</li>
<li><strong>Visualisierungen</strong>: Klare, aussagekr√§ftige Plots</li>
<li><strong>Business Impact</strong>: Verbindung zu Gesch√§ftszielen</li>
<li><strong>Limitations</strong>: Ehrliche Diskussion von Einschr√§nkungen</li>
<li><strong>Next Steps</strong>: Konkrete Handlungsempfehlungen</li>
</ul>
<hr />
<h2 id="wichtige-formeln-quick-reference">Wichtige Formeln - Quick Reference</h2>
<h3 id="schadenkennzahlen">Schadenkennzahlen</h3>
<ul>
<li><strong>Loss Frequency Rate</strong>: <code>Anzahl Sch√§den / Anzahl Versicherungsjahre</code></li>
<li><strong>Average Loss per Claim</strong>: <code>Gesamtschaden / Anzahl Sch√§den</code></li>
<li><strong>Loss Ratio</strong>: <code>(Gesamtschaden / Gesamtpr√§mie) √ó 100%</code></li>
</ul>
<h3 id="modellgute-klassifikation">Modellg√ºte - Klassifikation</h3>
<ul>
<li><strong>Accuracy</strong>: <code>(TP + TN) / (TP + TN + FP + FN)</code></li>
<li><strong>Precision</strong>: <code>TP / (TP + FP)</code></li>
<li><strong>Recall</strong>: <code>TP / (TP + FN)</code></li>
<li><strong>F1-Score</strong>: <code>2 √ó (Precision √ó Recall) / (Precision + Recall)</code></li>
</ul>
<h3 id="modellgute-regression">Modellg√ºte - Regression</h3>
<ul>
<li><strong>MAE</strong>: <code>mean(|y_true - y_pred|)</code></li>
<li><strong>RMSE</strong>: <code>sqrt(mean((y_true - y_pred)¬≤))</code></li>
<li><strong>R¬≤</strong>: <code>1 - (SS_res / SS_tot)</code></li>
</ul>
<h3 id="wahrscheinlichkeitsverteilungen">Wahrscheinlichkeitsverteilungen</h3>
<ul>
<li><strong>Poisson</strong>: <code>P(k) = (Œª·µè √ó e‚ÅªŒª) / k!</code></li>
<li><strong>Lognormal</strong>: Parametrisiert durch Œº, œÉ</li>
</ul>
<hr />
<h2 id="wichtige-python-bibliotheken">Wichtige Python-Bibliotheken</h2>
<div class="codehilite"><pre><span></span><code><span class="c1"># Datenmanipulation</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">pandas</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">pd</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>

<span class="c1"># Machine Learning</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">sklearn.model_selection</span><span class="w"> </span><span class="kn">import</span> <span class="n">train_test_split</span><span class="p">,</span> <span class="n">cross_val_score</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">sklearn.preprocessing</span><span class="w"> </span><span class="kn">import</span> <span class="n">StandardScaler</span><span class="p">,</span> <span class="n">LabelEncoder</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">sklearn.ensemble</span><span class="w"> </span><span class="kn">import</span> <span class="n">RandomForestClassifier</span><span class="p">,</span> <span class="n">GradientBoostingRegressor</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">sklearn.linear_model</span><span class="w"> </span><span class="kn">import</span> <span class="n">LogisticRegression</span><span class="p">,</span> <span class="n">PoissonRegressor</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">sklearn.metrics</span><span class="w"> </span><span class="kn">import</span> <span class="p">(</span><span class="n">accuracy_score</span><span class="p">,</span> <span class="n">precision_score</span><span class="p">,</span> <span class="n">recall_score</span><span class="p">,</span>
                            <span class="n">f1_score</span><span class="p">,</span> <span class="n">roc_auc_score</span><span class="p">,</span> <span class="n">mean_absolute_error</span><span class="p">,</span>
                            <span class="n">mean_squared_error</span><span class="p">,</span> <span class="n">r2_score</span><span class="p">)</span>

<span class="c1"># Statistik</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">scipy</span><span class="w"> </span><span class="kn">import</span> <span class="n">stats</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">statsmodels.api</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">sm</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">statsmodels.genmod</span><span class="w"> </span><span class="kn">import</span> <span class="n">families</span>

<span class="c1"># Visualisierung</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">seaborn</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">sns</span>

<span class="c1"># Zeitreihen</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">statsmodels.tsa.arima.model</span><span class="w"> </span><span class="kn">import</span> <span class="n">ARIMA</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">prophet</span><span class="w"> </span><span class="kn">import</span> <span class="n">Prophet</span>

<span class="c1"># Moderne ML</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">xgboost</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">xgb</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">lightgbm</span><span class="w"> </span><span class="kn">import</span> <span class="n">LGBMClassifier</span>
</code></pre></div>

<hr />
<h2 id="checkliste-fur-vorstellungsgesprach">Checkliste f√ºr Vorstellungsgespr√§ch</h2>
<ul>
<li>[ ] Verstehe die vier Hauptthemen (Schadenklassifikation, Wahrscheinlichkeitsmodelle, Tarifierung, Kennzahlensystem)</li>
<li>[ ] Kenne die wichtigsten Metriken zur Modellg√ºtepr√ºfung</li>
<li>[ ] Kann Python-Code f√ºr versicherungsspezifische Analysen schreiben</li>
<li>[ ] Verstehe Loss Ratio, Claim Frequency, Claim Severity</li>
<li>[ ] Kenne GLM, Poisson Regression, Gamma Regression</li>
<li>[ ] Kann Confusion Matrix, ROC-AUC, F1-Score interpretieren</li>
<li>[ ] Verstehe die Rolle des operativen Controllings</li>
<li>[ ] Bereit f√ºr Case Study mit strukturiertem Ansatz</li>
</ul>
<hr />
<p><em>Dieses Dokument dient als umfassende Vorbereitung f√ºr das Vorstellungsgespr√§ch als Data Scientist im operativen Controlling der Sachversicherung.</em></p>
<p><strong>Viel Erfolg bei deinem Vorstellungsgespr√§ch! üéØ</strong></p>
</body>
</html>